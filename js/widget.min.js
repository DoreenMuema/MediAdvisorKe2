var StampedFn=StampedFn||function(e,t){function a(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||e.opera),t}function s(e){if("click"===e.type)return!0;if("keypress"!==e.type)return!1;var t=e.charCode||e.keyCode;return 32===t||13===t||void 0}function r(a){var s,i=t.createElement("span");i.appendChild(t.createTextNode(a)),i.id="tempCopyToClipboard",t.body.append(i),(s=t.createRange()).selectNode(i),e.getSelection().removeAllRanges(),e.getSelection().addRange(s),t.execCommand("copy"),e.getSelection().removeAllRanges(),i.remove()}function o(){return(o=Object.assign||function(e){for(var t,a,s=1;s<arguments.length;s++)for(a in t=arguments[s])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)}function n(a,s){var i,r;s?(ue("Using included jQ"),qe=s,e.jQueryStamped=qe,ue(qe)):(ue("Loaded jQ"),e.jQueryStamped=qe),/msie/.test(e.navigator.userAgent.toLowerCase())&&(qe.support.cors=!0),1!=Fe.exclude_font&&qe("head").append(qe("<link/>",{rel:"stylesheet",href:"//fonts.googleapis.com/css?family=Open+Sans:400,600&display=swap",type:"text/css"})),(i=me("stamped_referral_code")||me("stamped_ref"))&&(ge("stamped_referral_code",{code:i}),Fe.referral_code=i),(r=fe("stamped_referral_code"))&&r.code&&(Fe.referral_code=r.code),ue("Library Starting..."),qe.isReady?d():qe(t).ready((function(){d()})),setTimeout((function(){$e||(ue("Library not started, fallback"),d())}),3e3)}function d(){$e||(ue("Started library"),ye("stamped:init:starting"),l(),p()),$e=!0}function l(){if(ue("Starting UGC..."),(Ke=qe(rt)).length){if(qe.trim(Ke.html())){q(),W(),z(),K(),G(),V();try{e.LazyLoadStamped&&LazyLoadStamped.update&&LazyLoadStamped.update()}catch(e){}}else N();qe(t).on("click keypress",".stamped-summary-ratings .summary-rating",(function(e){if(!0===s(e)){var t=qe(this).find(".summary-rating-bar"),a=t.attr("data-rating"),i=t.hasClass("selected");qe(".stamped-summary-ratings .summary-rating").each((function(){qe(this).removeClass("selected")})),qe(".summary-rating-bar").each((function(){qe(this).removeClass("selected")})),a&&(i?(pe(1),qe(".stamped-summary-ratings").removeClass("selected")):(t.addClass("selected"),qe(this).addClass("selected"),qe(".stamped-summary-ratings").addClass("selected"),pe(1,a)))}})),qe(t).on("mouseover mouseout",".stamped-form-review-rating a.fa",(function(e){var t,a,s;t=e.currentTarget,s=qe(t).attr("data-value"),a=qe(t).parent(),"mouseover"===e.type?(a.find("a.fa:lt("+s+")").removeClass("fa-star-o").addClass("fa-star"),a.find("a.fa:gt("+(s-1)+")").removeClass("spr-icon-star-hover").addClass("fa-star-o")):a.find("a.fa").removeClass("fa-star").addClass("fa-star-o")})),qe(t).on("click keypress",".stamped-tabs li",(function(e){!0===s(e)&&Q(this)})),qe(t).on("keypress",".stamped-summary-actions-newreview",(function(e){!0===s(e)&&oe("review")})),qe(t).on("keypress",".stamped-summary-actions-newquestion",(function(e){!0===s(e)&&oe("question")})),qe(t).on("keypress",".stamped-form-input a",(function(e){!0===s(e)&&ne(this)})),function(){var a="#shopry-rating-wrapper a.shopry-thumbs-up, #shopry-rating-wrapper a.shopry-thumbs-down, #shopry-rating-holder a.shopry-thumbs-up, #shopry-rating-holder a.shopry-thumbs-down, #stamped-rating-holder a.stamped-thumbs-up, #stamped-rating-holder a.stamped-thumbs-down, .stamped-rating-holder a.stamped-thumbs-up, .stamped-rating-holder a.stamped-thumbs-down";qe(t).off("click keypress",a).on("click keypress",a,(function(t){var a;if(!0===s(t)){var i=qe(this).attr("data-review-id"),r=qe(this).attr("data-question-id"),o=qe(this).attr("data-rating"),n=Ke.attr("data-product-id"),d=qe(this),l=d.parent();l.fadeTo("slow",.3),d.addClass("disable-link"),a=i?"reviews":"questions",qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/"+a+"/vote",data:{productId:n,reviewId:i,questionId:r,vote:o,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl},success:function(e){qe(".stamped-thumbs-up i",l).html("&nbsp; "+e.voteUp),qe(".stamped-thumbs-down i",l).html("&nbsp; "+e.voteDown),l.fadeTo("slow",1),d.removeClass("disable-link")}})}}))}(),function(){var e=".stamped-share-button, .stamped-share-icon";qe(t).off("click keypress",e).on("click keypress",e,(function(e){!0===s(e)&&qe(this).parent().find(".stamped-share-links").fadeToggle()}))}(),qe(t).on("click keypress",".stamped-summary-actions-mobile-filter",(function(e){if(!0===s(e)){var t=qe(".stamped-filters-wrapper");t.hasClass("stamped-mobile-visible")?(t.slideUp(),t.removeClass("stamped-mobile-visible")):(t.slideDown(),t.addClass("stamped-mobile-visible"))}})),qe(t).on("click keypress",".stamped-summary-keywords-list li",(function(e){if(!0===s(e)){var t=qe(this);t.hasClass("selected")?(qe(".stamped-summary-keywords-list li").removeClass("selected"),qe(Ke).removeAttr("data-keyword")):(qe(".stamped-summary-keywords-list li").removeClass("selected"),t.addClass("selected"),qe(Ke).attr("data-keyword",t.text().trim())),qe(".stamped-summary-actions-clear").show(),pe(1)}})),qe(t).on("change keyup",".stamped-reviews-search-input",(function(e){var t=qe(this).val();t?(qe(".stamped-reviews-search-clear").show(),qe(".stamped-reviews",Ke).attr("data-filtered","true")):(qe(".stamped-reviews-search-clear").hide(),qe(".stamped-reviews",Ke).removeAttr("data-filtered")),13==e.keyCode&&(t=qe(this).val())&&(qe(Ke).attr("data-search",t.trim()),qe(".stamped-summary-actions-clear").show(),M(),pe(1))})),qe(t).on("click keypress",".stamped-reviews-search-button",(function(){if(!0===s(event)){var e=qe(".stamped-reviews-search-input").val();e&&(qe(Ke).attr("data-search",e.trim()),qe(".stamped-summary-actions-clear").show(),M(),pe(1))}})),qe(t).on("click keypress",".stamped-reviews-search-clear",(function(e){!0===s(e)&&(qe(".stamped-reviews-search-clear").hide(),qe(".stamped-reviews-search-input").val(""),qe(Ke).removeAttr("data-search"),pe(1))})),qe(t).on("click keypress",".stamped-summary-actions-clear",(function(e){!0===s(e)&&ce(qe(this).data("type"))})),qe(t).on("change keyup",".stamped-questions-search-input",(function(e){var t=qe(this).val();t?(qe(".stamped-questions-search-clear").show(),qe(".stamped-questions",Ke).attr("data-filtered","true")):(qe(".stamped-questions-search-clear").hide(),qe(".stamped-questions",Ke).removeAttr("data-filtered")),13==e.keyCode&&(t=qe(this).val())&&(qe(Ke).attr("data-search-qna",t.trim()),qe(".stamped-summary-actions-clear").show(),le())})),qe(t).on("click keypress",".stamped-questions-search-button",(function(){if(!0===s(event)){var e=qe(".stamped-questions-questions-input").val();e&&(qe(Ke).attr("data-search-qna",e.trim()),qe(".stamped-summary-actions-clear").show(),le())}})),qe(t).on("click keypress",".stamped-questions-search-clear",(function(e){!0===s(e)&&(qe(".stamped-questions-search-clear").hide(),qe(".stamped-questions-search-input").val(""),qe(Ke).removeAttr("data-search-qna"),le())})),qe(t).one("stamped:reviews:loaded",(function(){ue("Main Widget event triggered reload once"),q(),W(),z(),V(),me("write_review")&&oe("review"),me("write_question")&&oe("question")})),qe(t).on("stamped:reviews:loaded",(function(){ue("Main Widget event triggered reload"),st=[],K(),G();try{e.LazyLoadStamped&&LazyLoadStamped.update&&LazyLoadStamped.update()}catch(e){}qe(".stamped-tabs > li").click((function(){var e;Array.prototype.slice.call(this.parentNode.children).forEach((function(e){e.setAttribute("aria-selected",!1)})),e=this.getAttribute("aria-selected"),this.setAttribute("aria-selected",!JSON.parse(e))})),qe(".stamped-share-icon").click((function(){var e=qe(this).siblings(".stamped-share-links"),t=e.attr("aria-expanded"),a=void 0!==t&&!1!==t?t:"false";e.attr("aria-expanded","true"==a?"false":"true"),qe(this).toggleClass("stamped-active")})),qe(".stamped-rating-holder > a").click((function(){var e;Array.prototype.slice.call(this.parentNode.children).forEach((function(e){e.setAttribute("aria-pressed",!1)})),e=this.getAttribute("aria-pressed"),this.setAttribute("aria-pressed",!JSON.parse(e))}))}))}qe(t).one("stamped:launcher:loaded",(function(){var t=me("rewards-launcher");qe(e).on("hashchange",(function(){location.hash.indexOf("stamped-rewards")>=0&&u()})),t&&("open"==t&&u(),t.indexOf("view-")>-1&&(u(!0),I(t)))})),P(),$();var a=me("stamped_r_id");a&&1!=Fe.disable_single_review&&function(a){qe.ajax({type:"GET",url:Fe.SECURE_ENDPOINT+"/widget/reviews",data:{reviewId:a,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,type:"single",showAvatar:"True",minRating:1},success:function(e){e.data&&StampedFn.openUGCModal([e.data],0,t,1,!1,0)},error:function(){}})}(a)}function p(e){ue("Starting Rewards...");var t=qe("#stamped-rewards-init");if(e&&e.customer)return ue("Started Rewards with direct data"),ot=e,void m();e?(ue("Started Rewards with JS data"),ot.customer=e,c()):t.length>0?(ue("Started Rewards with div data"),ot.customer={customerId:t.data("customer-id"),customerEmail:t.data("customer-email"),customerFirstName:t.data("customer-first-name"),customerLastName:t.data("customer-last-name"),customerTags:t.data("customer-tags"),customerLocale:t.data("customer-locale"),totalOrders:0,totalSpent:t.data("customer-total-spent"),isAcceptMarketing:t.data("customer-accepts-marketing"),authToken:t.data("key-auth")},c()):ue("Started Rewards no init customer data")}function c(){var t,a,s;ue("Loading Rewards API init..."),t=Fe.metafields||"",ot&&ot.customer&&t&&(ot.customer.metafields=t),a=JSON.stringify(ot.customer),s=Fe.is_test;let i=Fe.SECURE_ENDPOINT+"/v2/rewards/init?",r=e.StampedGlobalOptions.storeUrl?encodeURIComponent(e.StampedGlobalOptions.storeUrl):e.StampedGlobalOptions.sId;qe.ajax({type:"GET",dataType:"json",url:`${Fe.SERVICE_HOST.svc_identity}/shop/${r}/check-feature/loyalty2023`,success:function(e){e.hasFeature||je?(console.log("Enabling Loyalty 2.0..."),Le=!0,i=`${Fe.SERVICE_HOST.svc_loyalty_widget}/launcher?`):(Le=!1,console.log("Enabling Loyalty 1.0..."))},error:function(){Le=!1,console.log("Error, default to Loyalty 1.0...")}}).then((()=>{const t={apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,debug:null,isTest:s,isPreview:Fe.is_preview,referralCode:Fe.referral_code};je&&(t.testLoyalty2023=je,Ae&&(t.testLoyaltyAccount=Ae)),console.log("Loading",i),qe.ajax({type:"POST",url:i+qe.param(t),xhrFields:{withCredentials:!0},data:a,dataType:"json",contentType:"application/json; charset=utf-8",success:function(e){ye("stamped:rewards:init"),ot=e,m()}})}))}function m(){!function(){var a;qe("#stamped-rewards-init").length||((a=t.createElement("div")).setAttribute("id","stamped-rewards-init"),t.body.appendChild(a));let s=e.StampedGlobalOptions.storeUrl?encodeURIComponent(e.StampedGlobalOptions.storeUrl):e.StampedGlobalOptions.sId;qe.ajax({type:"GET",dataType:"json",url:`${Fe.SERVICE_HOST.svc_identity}/shop/${s}/check-feature/loyalty2023`,success:function(e){Le=!(!e.hasFeature&&!je)},error:function(){Le=!1,console.log("Error, default to Loyalty 1.0...")}})}(),ot&&ot.html&&((ze=qe("#stamped-rewards-init")).html(ot.html.main),function(){We=qe(".stamped-rewards-launcher",ze),Be=qe(".stamped-launcher-button",ze),Qe=qe("<iframe>");var e=Be.html();ue("Func _buildIframeLauncher: width:"+Be.width(),1),ue("Func _buildIframeLauncher: outerWidth:"+Be.outerWidth(),1),ue("Func _buildIframeLauncher: var launcherWidth:"+(et=Be.width()+40),1),Be.width(et),Be.html(Qe),We.hide(),setTimeout((function(){var t,s,i;Ye=Qe[0].contentWindow.document,Qe[0].contentWindow.StampedFn=StampedFn,Qe[0].contentWindow.jQuery=jQuery,t=qe("body",Ye),s=qe("head",Ye),t.html(e),t.append(qe("#stamped-rewards-main-css",ze).clone()),s.append(qe("<link/>",{rel:"stylesheet",href:"//cdn1.stamped.io/files/rewards-launcher.min.css",type:"text/css"})),0!=Fe.includes_options.rewards_button_js&&((i=Ye.createElement("script")).type="text/javascript",i.src="https://kit.fontawesome.com/c66d4e7704.js",i.setAttribute("data-observe-mutations","true"),Ye.body.appendChild(i)),s.append("<style>"+nt+' body { overflow:hidden; } .stamped-launcher-icon-opened { font-family:"Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; display:inline-block; width: 100%; margin-top: -2px; text-align:center;}</style>'),a()&&t.attr("data-mobile",!0),He=qe(".stamped-launcher-icon-closed",t),Je=qe(".stamped-launcher-icon-opened",t),We.fadeIn()}),0)}(),function(){Ve=qe(".stamped-rewards-base",ze),$launcherCss=qe("#stamped-rewards-main-css",ze).clone(),Xe=qe("<iframe>");var e=Ve.html();Ve.html(Xe),setTimeout((function(){var t,s,i,r,o;Ze=Xe[0].contentWindow.document,Xe[0].contentWindow.StampedFn=StampedFn,Xe[0].contentWindow.jQuery=jQuery,t=qe("body",Ze),s=qe("head",Ze),t.html(e),t.append(qe("#stamped-rewards-main-css",ze).clone()),s.append(qe("<link/>",{rel:"stylesheet",href:"//cdn1.stamped.io/files/rewards-main.min.css",type:"text/css"})),1!=Fe.exclude_font&&s.append(qe("<link/>",{rel:"stylesheet",href:"//fonts.googleapis.com/css?family=Open+Sans:400,600&display=swap",type:"text/css"})),Le?(console.log("Loading new FA css..."),i="//s3-us-west-2.amazonaws.com/stamped.io/cdn/fontawesome/css/all-6.4.min.css",(r=Ze.createElement("link")).rel="stylesheet",r.href=i,Ze.getElementsByTagName("head")[0].appendChild(r)):(s.append("<script>window.FontAwesomeConfig = { searchPseudoElements: true };<\/script>"),(o=Ze.createElement("script")).type="text/javascript",o.src="https://kit.fontawesome.com/c66d4e7704.js",o.setAttribute("data-observe-mutations","true"),o.setAttribute("data-search-pseudo-elements","true"),Ze.body.appendChild(o)),t.append("<style>"+nt+' .stamped-rewards-window { font-family:"Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; }</style>'),a()&&t.attr("data-mobile",!0),ot.customer&&ot.customer.customerEmail?t.attr("data-logged-in",!0):t.attr("data-logged-in",!1),1==ot.branding&&t.attr("data-branding",!0),$wrapperCards=qe("#stamped-rewards-cards",Ze),$wrapperViews=qe("#stamped-rewards-views",Ze),k(),S("rewards"),ye("stamped:launcher:loaded")}),1e3)}(),D())}function u(e){var t=Ve.hasClass("opened");qe("body",Ze).addClass("opened"),t?1!=e&&(ue("Func _toggleRewardsModal: var launcherWidth:"+et,1),Ve.removeClass("opened"),Ve.fadeOut(),We.removeClass("opened"),He.removeClass("rotateIn"),Je.removeClass("fadeOut"),Je.addClass("fadeIn"),Be.animate({width:et+"px"},0),setTimeout((function(){I("main")}),1e3),ye("stamped:launcher:closed")):(setTimeout((function(){Ve.addClass("opened")}),100),We.addClass("opened"),Ve.fadeIn(),He.addClass("rotateIn"),He.removeClass("rotateOut"),Je.addClass("fadeOut"),Je.removeClass("fadeIn"),Be.animate({width:"40px"},0),qe(".stamped-rewards-content-container",Ze).scrollTop(0),qe(".stamped-rewards-header",Ze).css("height","auto"),ye("stamped:launcher:opened"),h())}function h(){"true"!=ae("stamped-launcher-opened")&&(qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/tracking/event?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,source:"launcher",event:"open"}),dataType:"json",success:function(){}}),te("stamped-launcher-opened",!0,1))}function g(t,a,s){var i=t.search,r=t.customOptionTitle?t.customOptionTitle+"||"+t.customOptionValue:"",o=t.topic,n=i||o||r,d=1;r&&(d=2),o&&(d=3),qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/tracking/event?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,event:"search",source:"m"}),data:JSON.stringify({source:"m",sourceId:a,type:d,text:n,results:s}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){}})}function f(t){const a={apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl};je&&(a.testLoyalty2023=je,Ae&&(a.testLoyaltyAccount=Ae)),qe.ajax({type:"POST",url:`${Fe.SERVICE_HOST.svc_loyalty_widget}/launcher/points?`+qe.param(a),data:ot.customer,dataType:"json",success:function(e){setTimeout((function(){qe(".stamped-rewards-header-main-points, .stamped-rewards-header-small-points",Ze).html(e.points_current_with_name),qe("#label-balance-points",Ze).html(e.points_current_with_name);let t=qe("#stamped-rewards-widget");qe(".stamped-rewards-widget-points",t).html(e.points_current_with_name)}),100),t&&t(e)}})}function v(t){qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/v2/rewards/points?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl}),data:ot.customer,dataType:"json",success:function(e){setTimeout((function(){qe(".stamped-rewards-header-main-points, .stamped-rewards-header-small-points",Ze).html(e.points_current_with_name)}),5e3),t&&t(e)}})}function w(t){return t=t||{},ot||ot.customer||console.log("Customer not logged in to create reward activity"),qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/v2/rewards/add?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,campaignId:t.campaignId}),data:ot.customer,dataType:"json",success:function(e,a,s){t.callback&&t.callback(e,a,s),v(),ye("stamped:rewards:earned",{detail:e})}})}function y(t){t=t||{},qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/v2/rewards/redeem?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,campaignId:t.campaignId,points:t.points}),data:ot.customer,dataType:"json",success:function(e){t.callback&&t.callback(e),v(),ye("stamped:rewards:redeemed",{detail:e})}})}function b(t){t=t||{},qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/v2/rewards/addBirthday?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,dateBirthday:t.birthday}),data:ot.customer,success:function(){t.callback&&t.callback()}})}function S(e){var t,a,s;for($wrapperCards.html(""),qe("body",Ze).attr("data-view",e),t=0;t<ot.html.cards.length;t++)(a=ot.html.cards[t])&&a.html&&e==a.type&&((s=qe(a.html)).attr("data-key",a.key),$wrapperCards.append(s))}function k(){function a(){let t=e.StampedGlobalOptions.storeUrl?encodeURIComponent(e.StampedGlobalOptions.storeUrl):e.StampedGlobalOptions.sId;return qe.ajax({type:"GET",dataType:"json",url:`${Fe.SERVICE_HOST.svc_identity}/shop/${t}/check-feature/loyalty2023`,success:function(e){Le=!(!e.hasFeature&&!je)},error:function(){Le=!1,console.log("Error, default to Loyalty 1.0...")}}),Le}var s;qe(Ze).on("click",".stamped-rewards-header-close",(function(){u()})),qe(Ze).on("click","#launcherSendAffiliateInvite",(function(){"Send more"==qe("#launcherSendAffiliateInvite",Ze)[0].innerHTML?j():L()})),qe(t).on("touchstart",(function(){s=!0})),qe(t).on("touchmove",(function(){s=!1})),qe(t).on("click touchend",(function(e){if("click"===e.type&&(s=!0),s&&"stamped-rewards-init"!==e.target.id&&!qe(e.target).parents("#stamped-rewards-init").length&&!qe(e.target).parents(".stamped-rewards-base").length&&!qe(e.target).parents(".stamped-rewards-launcher").length&&!qe(e.target).parents("#stamped-rewards-widget").length){var t=qe(".stamped-rewards-base",ze).hasClass("opened");setTimeout((function(){t&&StampedFn.toggleLauncher()}),300)}})),qe(Ze).on("click",'[data-campaign-completed="false"] .stamped-reward-card-button-earn',(function(){var t,s=qe(this).parent(".stamped-rewards-card-earn"),i=qe(this);let r=s.data("campaign-id"),o=s.data("event-type");if(a()){if("celebrateBirthday"===o){let t=qe(".stamped-rewards-birthday-input-holder",Ze);t.show();let a=qe(".stamped-rewards-birthday-input-holder select.DOBDay option:checked",Ze).val(),n=qe(".stamped-rewards-birthday-input-holder select.DOBMonth option:checked",Ze).val(),d=qe(".stamped-rewards-birthday-input-holder select.DOBYear option:checked",Ze).val();if(a&&n&&d){let l=d+"-"+n+"-"+a;i.addClass("btn-loading"),i.html('<span class="stamped-button-icon stamped-button-loading"></span>');let p=e.StampedGlobalOptions.storeUrl,c=e.StampedGlobalOptions.sId,m=e.StampedGlobalOptions.apiKey;qe.ajax({type:"POST",url:`${Fe.SERVICE_HOST.svc_loyalty_widget}/customer/update/date-of-birth?storeUrl=${p}&sId=${c}&apiKey=${m}`,data:{email:ot.customer.customerEmail,authToken:ot.customer.authToken,dateOfBirth:l},dataType:"json",success:function(e){i.html('<span class="stamped-button-icon stamped-button-completed"><i class="fa-solid fa-check"></i></span>'),i.attr("disabled",!0),t.hide(),s.attr("data-campaign-completed","true"),s.attr("data-birthday","true"),ot.customer.dateBirthday=!0,T(r,o),ye("stamped:rewards:redeemed",{detail:e})},error:function(e){console.log("Birthday update failed"),console.log(e)}})}return}i.addClass("btn-loading"),i.html('<span class="stamped-button-icon stamped-button-loading"></span>');T(r,o,(function(){setTimeout((function(){i.removeClass("btn-loading"),i.addClass("stamped-button-disabled"),i.hide()}),200)}),(function(){i.removeClass("btn-loading"),i.addClass("stamped-button-disabled"),i.hide()}))}else if("AccountBirthday"==o){(t=qe(".stamped-rewards-birthday-input-holder",Ze)).show();var n=qe(".stamped-rewards-birthday-input-holder select.DOBDay option:checked",Ze).val(),d=qe(".stamped-rewards-birthday-input-holder select.DOBMonth option:checked",Ze).val(),l=qe(".stamped-rewards-birthday-input-holder select.DOBYear option:checked",Ze).val();n&&d&&l&&(A(i,"loading",!0),E({campaignId:r,campaignEventType:o,birthday:l+"-"+d+"-"+n,callback:function(){A(i,"active",!0,null,(function(){s.attr("data-campaign-completed","true"),s.attr("data-birthday","true"),c()})),t.hide()}}))}else"Review"==o||"ReviewPhoto"==o||"ReviewVideo"==o?(_("reviews"),I("main")):(A(i,"loading",!0),E({campaignId:r,campaignEventType:o,callback:function(){A(i,"active",!0,null,(function(){s.attr("data-campaign-completed","true")}))}}))})),qe(Ze).on("click",'[data-campaign-redeemable="true"] .stamped-reward-card-button-spend',(function(){var e=qe(this),t=e.parent(".stamped-rewards-card-spend"),s=t.data("campaign-id"),i=t.data("coupon-type");if(a()){let t=function(t){let a={};a.couponCode=t.code,a.title=t.title,I("view-coupon",null,a),A(e,"active",!0,1)};U(s,i,t)}else"Variable"==i?I("view-redeem-variable",null,{entityId:s}):(A(e,"loading",!0),x({campaignId:s,callback:function(t){I("view-coupon",null,t.rewardCampaignCoupon),A(e,"active",!0,1)}}))})),qe(Ze).on("click",".stamped-reward-referral-platforms button",(function(){var e=qe(this).attr("href");e&&R(e)})),qe(Ze).on("click",".stamped-rewards-header-menu span",(function(){var e=qe(this).attr("data-target");e!=$wrapperCards.attr("data-target")&&($wrapperCards.attr("data-target",e),S(e),qe(".stamped-rewards-content-container",Ze).scrollTop(0),qe(".stamped-rewards-header-menu .active",Ze).removeClass("active"),qe(this,Ze).addClass("active"))})),qe(".stamped-rewards-content-container",Ze).on("scroll",(function(){var e,t,a,s=qe(".stamped-rewards-content-container",Ze).scrollTop();if(s<=1)return qe(".stamped-rewards-background",Ze).height("200px"),void qe(".stamped-rewards-header",Ze).height("auto");e=qe(".stamped-rewards-header-content",Ze).outerHeight()+15,qe(".stamped-rewards-header",Ze).css("min-height","70px"),t=200,t-=s,qe(".stamped-rewards-background",Ze).height(t),a=e,a-=s,qe(".stamped-rewards-header",Ze).height(a)}))}function _(e){"reviews"==e&&qe('.stamped-rewards-header-menu span[data-target="reviews"]',Ze).trigger("click")}function I(t,a,s,i=null){var r,o,n,d,l,p,c,m;if(Me=qe(".stamped-rewards-window",Ze),qe(".stamped-rewards-content-container",Ze).scrollTop(0),qe(".stamped-rewards-header-nav",Ze).attr("onclick","StampedFn.loadLauncherView('main');"),qe("body",Ze).attr("data-view",t),r=qe(a).attr("data-title"),Me)if("main"==t)Me.removeClass("stamped-rewards-nav-small"),Me.addClass("stamped-rewards-nav-big"),qe(".stamped-rewards-header-main, .stamped-rewards-header-menu",Ze).fadeIn(),qe(".stamped-rewards-header-small",Ze).hide(),o=qe(".stamped-rewards-header-content",Ze).outerHeight()+15,qe(".stamped-rewards-header",Ze).height(o),qe(".stamped-rewards-background",Ze).height("200"),$wrapperViews.hide(),$wrapperCards.fadeIn();else{if(n=!1,s&&1==s.reload)n=!1;else if("view-redeem-variable"==t)n=!1;else for(d=0;d<ot.html.views.length;d++)(l=ot.html.views[d]).key==t&&(l.title&&(r=l.title),n=!0,C(l.html),O(t,r,s));if(!n){C(),O(t,r,s),p=null,s&&s.entityId&&(p=s.entityId),c=Fe.is_test;let a=e.StampedGlobalOptions.storeUrl?encodeURIComponent(e.StampedGlobalOptions.storeUrl):e.StampedGlobalOptions.sId;qe.ajax({type:"GET",dataType:"json",url:`${Fe.SERVICE_HOST.svc_identity}/shop/${a}/check-feature/loyalty2023`,success:function(e){Le=!(!e.hasFeature&&!je)},error:function(){Le=!1,console.log("Error, default to Loyalty 1.0...")}}),m=Fe.SECURE_ENDPOINT+"/v2/rewards/cardview",Le&&(m=`${Fe.SERVICE_HOST.svc_loyalty_widget}/templates/cardview`);const o={apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,viewKey:t,entityId:p,referralCode:Fe.referral_code,isTest:c};je&&(o.testLoyalty2023=je,Ae&&(o.testLoyaltyAccount=Ae)),qe.ajax({type:"POST",url:m+"?"+qe.param(o),data:ot.customer,dataType:"json",success:function(e){e&&e.html?(ot.html.views.push(e),setTimeout((function(){var a=!1;"view-redeem-variable"===e.key&&(a=!0,i&&i()),C(e.html,!1,a),O(t,e.title||r,s)}),1e3)):I("main")},error:function(){I("main")}})}}}function C(e,t,a){if(e){var s=qe(e);$wrapperViews.html(s),$wrapperViews.removeClass("loading")}else $wrapperViews.html(""),qe(".stamped-view-loader",$wrapperViews).length||$wrapperViews.append(qe('<div class="stamped-view-loader"></div>')),$wrapperViews.addClass("loading");0!=t&&(Me.addClass("stamped-rewards-nav-small"),Me.removeClass("stamped-rewards-nav-big"),qe(".stamped-rewards-header-main, .stamped-rewards-header-menu",Ze).hide(),qe(".stamped-rewards-header-small",Ze).fadeIn(),$wrapperCards.hide(),$wrapperViews.fadeIn()),a&&StampedFn.toggleLauncher(!0)}function O(e,t,a){var s,i=(a?a.viewTitle:t)||t;if("view-coupon"==e&&(qe(".stamped-reward-coupon-code",$wrapperViews).text(a.couponCode),qe(".stamped-reward-card-title",$wrapperViews).html(a.title),function(e,t){qe(".stamped-rewards-header-nav",Ze).attr("onclick","StampedFn.loadLauncherView('"+e+"', null, { reload: "+(t||!1)+"});")}("view-your-rewards",!0)),"view-earnings"==e&&ot&&ot.customer&&(s=qe('[data-event-type="AccountBirthday"]',Ze),Le&&(s=qe('[data-event-type="celebrateBirthday"]',Ze)),s.length&&(ot.customer.dateBirthday?s.attr("data-birthday","true"):(s.attr("data-birthday","false"),s.prepend(qe(".stamped-rewards-birthday-input-holder",Ze))))),"view-redeem-variable"==e&&(".range-slider__range",$selectorInput=qe(".range-slider__range",$wrapperViews),$selectorInput.length)){var r=$selectorInput.data("format-points"),o=$selectorInput.data("format-points-name"),n=$selectorInput.data("currency"),d=$selectorInput.attr("step"),l=$selectorInput.data("discount-value");function e(){var e=$selectorInput.val(),t=e/d*l,a=new Intl.NumberFormat("en-US",{style:"currency",currency:n});qe("#redeem-points",$wrapperViews).text(r.formatStringStamped(e,o)),qe("#redeem-amount",$wrapperViews).text(a.format(t))}function t(e){var t=$selectorInput.val(),s={campaignId:a.entityId,points:t};Le?U(a.entityId,"variableDiscount",(function(e){let t=e.code,a=e.title;I("view-coupon",null,{couponCode:t,title:a,viewTitle:a})}),null,t):StampedFn.rewardsRedeem(qe(e),s,(function(e){var t=e.rewardCampaignCoupon.couponCode,a=e.rewardCampaignCoupon.title;I("view-coupon",null,{couponCode:t,title:a,viewTitle:a})}))}$selectorInput.on("input",(function(){e()})),qe(".stamped-rewards-content-action-button ",$wrapperViews).on("click",(function(){t(this)})),e()}i&&function(e){qe(".stamped-rewards-header-small-title",Ze).text(e)}(i)}function T(t,a,s=null,i=null){ot.shopId;const r=ot.customer.customerId;var o=ot.links;if(!r)return void(e.location.href=o.signup);e.StampedGlobalOptions.sId=ot.shopId;let n=ot.campaigns.earnings.filter((e=>e.id===t))[0]||ot.campaigns.tierEarnings.filter((e=>e.id===t))[0],d="";switch(a){case"facebookLike":d="socials/facebook_like",e.open(n.socialLink,"_blank");break;case"facebookShare":d="socials/facebook_share",e.open(n.socialLink,"_blank");break;case"instagramFollow":d="socials/instagram_follow",e.open(n.socialLink,"_blank");break;case"twitterFollow":d="socials/twitter_follow",e.open(n.socialLink,"_blank");break;case"twitterShare":d="socials/twitter_share",e.open(n.socialLink,"_blank");break;case"youTubeSubscribe":d="socials/youtube_subscribe",e.open(n.socialLink,"_blank");break;case"tikTokFollow":d="socials/tiktok_follow",e.open(n.socialLink,"_blank");break;case"pinterestFollow":d="socials/pinterest_follow",e.open(n.socialLink,"_blank");break;case"celebrateBirthday":d="milestones/birthday";break;case"subscribeNewsletter":d="subscriptions/newsletter";break;case"writeReview":case"uploadVideo":case"uploadPhoto":return _("reviews"),void I("main")}d?qe.ajax({type:"POST",url:`${Fe.SERVICE_HOST.svc_loyalty_widget}/customer/transactions`,data:{event:d,ruleCorrelationId:t,customerId:r,authToken:ot.customer.authToken,apiKey:e.StampedGlobalOptions.apiKey,sId:ot.shopId||e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl},dataType:"json",success:function(e){s&&s(e),f(),ye("stamped:rewards:redeemed",{detail:e})},error:function(){console.log("Error submitting earn event transaction."),i&&i()}}):console.log(`Error: Earn Activity event ${d} not matched.`)}function E(t){var a,s;"AccountBirthday"==(a=(t=t||{}).campaignEventType)?b(t):("SocialFollowInstagram"==a||"SocialFollowFacebook"==a||"SocialShareFacebook"==a||"SocialFollowTwitter"==a||"SocialShareTwitter"==a||"SocialYouTube"==a||"SocialFollowTiktok"==a||"SocialShareTiktok"==a||"SocialFollowPinterest"==a)&&(w({campaignId:t.campaignId,callback:t.callback}),s=ot.links,"SocialFollowInstagram"==a?e.open(s.instagram,"_blank").focus():"SocialFollowFacebook"==a?e.open("https://www.facebook.com/plugins/page.php?href="+s.facebook,"_blank","location=yes,height=250,width=340,top=50,left=50,scrollbars=yes,status=yes"):"SocialShareFacebook"==a?e.open("https://www.facebook.com/sharer/sharer.php?u="+s.shop,"_blank","location=yes,height=500,width=500,top=50,left=50,scrollbars=yes,status=yes"):"SocialFollowTwitter"==a?e.open(s.twitter,"_blank").focus():"SocialShareTwitter"==a?e.open("https://twitter.com/intent/tweet?url="+s.shop,"_blank","location=yes,height=500,width=500,top=50,left=50,scrollbars=yes,status=yes"):"SocialYouTube"==a?e.open(s.youtube,"_blank"):"SocialFollowTiktok"==a||"SocialShareTiktok"==a?e.open(s.tiktok,"_blank"):"SocialFollowPinterest"==a&&e.open(s.pinterest,"_blank"))}function x(e){y({campaignId:(e=e||{}).campaignId,callback:e.callback})}function U(t,a,s=null,i=null,r=null,o=null){ot.shopId;const n=ot.customer.customerId;if(!n)return void(e.location.href=shopLinks.signup);e.StampedGlobalOptions.sId=ot.shopId;let d=ot.campaigns.spendings.filter((e=>e.id===t))[0]||ot.campaigns.tierSpendings.filter((e=>e.id===t))[0],l="";switch(a){case"freeShipping":l="redeem/shipping";break;case"giftCard":l="redeem/gift_card";break;case"posPercentageOff":l="redeem/percentage_pos";break;case"percentageOffDiscount":l="redeem/percentage";break;case"posFixedAmountDiscount":l="redeem/fixed_pos";break;case"fixedAmountDiscount":l="redeem/fixed";break;case"variableDiscount":l="redeem/variable";break;case"freeProduct":l="redeem/product";break;case"storeCredit":l="redeem/store_credit"}l?"redeem/variable"!==l||r?qe.ajax({type:"POST",url:`${Fe.SERVICE_HOST.svc_loyalty_widget}/customer/transactions`,data:{event:l,ruleCorrelationId:d.ruleCorrelationId,points:r,customerId:n,authToken:ot.customer.authToken,apiKey:e.StampedGlobalOptions.apiKey,sId:ot.shopId||e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl},dataType:"json",success:function(e){s&&s(e),f(),ye("stamped:rewards:redeemed",{detail:e})},error:function(){console.log("Error submitting spend event transaction."),i&&i()}}):I("view-redeem-variable",null,{entityId:t},o):console.log(`Error: Spend Activity event ${l} not matched.`)}function R(t){e.open(t,"_blank","location=yes,height=500,width=500,top=50,left=50,scrollbars=yes,status=yes")}function F(e){var t=qe("#stamped-rewards-apply-code",Ze);"active"==e&&qe(".stamped-rewards-coupons-view",Ze).attr("data-applied","true"),A(t,e)}function L(){let t=qe("#email-to",Ze),a=qe("#email-message",Ze),s=qe("#launcherSendAffiliateInvite",Ze),i=t.val(),r=a.val();StampedFn.getOptions();if(i){A(s,"loading",!0);let t=i.split(",").map((function(e){return e.trim()})),a=ot.shopId||e.StampedGlobalOptions.sId,o=e.StampedGlobalOptions.apiKey,n=`${Fe.SERVICE_HOST.svc_loyalty_widget}/customer/affiliate/send-invite?sId=${a}&apiKey=${o}`;t.map((e=>{qe.ajax({type:"POST",url:n,data:{to:e,from:ot.customer.customerEmail,customMessage:r}})})),s.html("Invite sent!"),setTimeout((function(){s.html("Send more"),s.removeClass("stamped-button-disabled")}),3e3)}}function j(){let e=qe("#email-to",Ze),t=qe("#email-message",Ze),a=qe("#launcherSendAffiliateInvite",Ze),s=a.attr("data-original-text");e.val(""),t.val(""),a.html(s)}function A(e,t,a,s,i){if("loading"==t){var r=e.width();e.attr("data-original-text",e.text()),e.addClass("stamped-button-disabled"),r>=10&&e.width(r),e.html('<span class="stamped-button-icon stamped-button-loading"></span>')}else a||e.html('<span class="stamped-button-icon stamped-button-completed"></span>'),setTimeout((function(){var t=e.attr("data-original-text");e.html(t),e.removeClass("stamped-button-disabled"),e.width("auto"),i&&i()}),s||7878)}function G(){var t,a,s,i,r;ue("Func initWidgetType"),"slider"==(t=qe(".stamped-container",Ke).attr("data-widget-style"))?(ue(be=qe(".stamped-reviews",Ke),1),ue("Func initWidgetType: var initialized:"+(a=be&&be.hasClass("slick-initialized")),1),a?(be.slick("slickAdd",qe(".stamped-reviews > .stamped-review")),qe('.stamped-reviews [class*="stamped-review"]',Ke).length<=0?qe("button.slick-arrow").hide():qe("button.slick-arrow").show()):he("//cdn.stamped.io/cdn/js/slick.min.js",(function(){be.slick(Fe.slick_options),be.on("afterChange",(function(e,t,a){var s;qe(".slick-next.slick-arrow").hasClass("slick-disabled")&&(_lastSlide=a,(s=qe(".stamped-pagination .next a")).length&&s.click())}))}))):"masonry"==t&&(s={container:".stamped-reviews",margin:{x:15,y:15},breakAt:{1500:4,1200:3,700:2,500:2},columns:4},e.macyInstanceConfig&&(e.macyInstanceConfig.breakAt&&(s.breakAt=e.macyInstanceConfig.breakAt),e.macyInstanceConfig.columns&&(s.columns=e.macyInstanceConfig.columns)),he("//cdn.stamped.io/cdn/js/macy2.js",(function(){e.macyInstanceStamped=Macy(s),ye("stamped:macy:loaded")}))),qe(".stamped-sort-select").length&&((i=Ke.attr("data-sort")||qe(".stamped-container",Ke).attr("data-widget-sort"))&&((r=qe('.stamped-sort-select option[value="'+i+'"]')).css("display")&&"none"!==r.css("display")&&qe(".stamped-sort-select").val(i)))}function N(e){Ke&&Ke.length&&!e||(Ke=qe(rt)),B()}function q(){ue("Creating Q&A"),J()}function P(){!function(){var a;ue("Loading Badges..."),(tt=qe(".stamped-product-reviews-badge[data-id], .stamped-product-reviews-badge[data-product-id]")).length&&(a=qe.map(tt,(function(e){if(!qe.trim(qe(e).html())&&(qe(e).attr("data-id")||qe(e).attr("data-product-id")||qe(e).attr("data-type")||qe(e).attr("data-product-type")||qe(e).attr("data-product-sku")||qe(e).attr("data-product-title")))return{productId:qe(e).attr("data-id")||qe(e).attr("data-product-id"),productType:qe(e).attr("data-product-type"),productSKU:qe(e).attr("data-product-sku")||qe(e).attr("data-product-sku2"),productTitle:qe(e).attr("data-product-title")}})),a&&a.length&&qe.ajax({type:"POST",dataType:"json",contentType:"application/json",url:Fe.SECURE_ENDPOINT+"/widget/badges"+(!0===Fe.is_disable_cache_badge?"?isUseCache=false":""),data:JSON.stringify({productIds:a,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl}),success:function(e){tt.each((function(){var t=qe(this).attr("data-id")||qe(this).attr("data-product-id"),a=qe(this).attr("data-type"),s=qe.map(e,(function(e,a){if(e.productId==t)return a}))[0];s>=0&&(!a||"review"==a)?qe(this).html(e[s].badge):s>=0&&"qna"==a&&qe(this).html(e[s].badgeqna)})),ye("stamped:badges:loaded")},error:function(){}})),qe(".stamped-product-reviews-badge[data-id].stamped-main-badge, .stamped-product-reviews-badge:first").length&&qe(t).on("click",".stamped-product-reviews-badge[data-id].stamped-main-badge, .stamped-product-reviews-badge:first",(function(){"qna"===qe(this).attr("data-type")?(qe("#stamped-questions-placeholder").length?ie("#stamped-questions-placeholder"):(Q(null,"questions"),ie(rt)),qe(".stamped-badge-caption[data-questions]").length&&"0"===qe(".stamped-badge-caption[data-questions]").attr("data-questions")&&qe(".new-question-form").show()):(Q(null,"reviews"),ie(rt))}))}()}function $(){var e,t,a=qe("#stamped-reviews-widget").length;ue("Creating display widgets "+a+" found"),ye("stamped:widget:reloading"),a>0&&(e=[],t=1,qe("[id=stamped-reviews-widget]").each((function(){var a,s=qe(this);s.attr("data-element-id",t),a=X(s),e.push(a),t++})),Z("ugc",e))}function D(){var t,a,s,i,r,o,n,d=ot;if(d.points&&(t=d.points.points,qe("[id=stamped-rewards-points-placeholder]").attr("onclick","StampedFn.toggleRewardsModal();"),qe("[id=stamped-rewards-points-placeholder]").html(d.points.points_current_with_name),qe('[id=stamped-rewards-points-placeholder][data-type="points-only"]').html(t),d.customer&&qe("[id=stamped-rewards-viptier-placeholder]").html(d.customer.vipTierTitle),(a=qe('[id=stamped-rewards-points-placeholder][data-type="points-price"]')).length&&t>=0&&(s=a.attr("data-ratio"),i=a.attr("data-symbol"),s&&(parseInt(s)&&(r=t>0?(t/s).toFixed(2):0,a.html(i+r))))),d.customer&&qe("[id=stamped-rewards-referral-placeholder]").html(d.customer.urlReferral),qe("#stamped-rewards-widget").length>0){o=[],n=1,qe("[id=stamped-rewards-widget]").each((function(){var e,t=qe(this);t.attr("data-element-id",n),e=X(t),o.push(e),n++}));let t=e.StampedGlobalOptions.storeUrl?encodeURIComponent(e.StampedGlobalOptions.storeUrl):e.StampedGlobalOptions.sId;qe.ajax({type:"GET",dataType:"json",url:`${Fe.SERVICE_HOST.svc_identity}/shop/${t}/check-feature/loyalty2023`,success:function(e){e.hasFeature||je?(Le=!0,function(e){const t={};je&&(t.testLoyalty2023=je,Ae&&(t.testLoyaltyAccount=Ae));const a=`${Fe.SERVICE_HOST.svc_loyalty_widget}/templates/widget?`;e.forEach((e=>{qe.ajax({type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(e),xhrFields:{withCredentials:!0},url:a+qe.param(t),success:function(e){let t=e.elementId;ee(qe('#stamped-rewards-widget[data-element-id="'+t+'"]'),e,e.translations,0)}})}))}(o)):Z("rewards",o)},error:function(){console.log("Error, default to Loyalty 1.0..."),Z("rewards",o)}})}}function K(){var e=qe(Ke).attr("data-limit-words")||qe(".stamped-container",Ke).attr("data-widget-limit-words"),t=qe(Ke).attr("data-keyword"),a=qe(Ke).attr("data-search");(e&&e>0||t||a)&&qe(".stamped-review",Ke).each((function(){var s,i,r,o=qe(".stamped-review-content-body:first",this);o.length&&((s=qe(o).html()).indexOf("stamped-review-read-more")<=-1&&(t||a?(t&&(i=H(s,t)),a&&(i=H(s,a)),qe(o).html(i)):(r=s.split(" ")).length>e&&(txtTrimmed=r.slice(0,e).join(" ")+"...",qe(o).html(txtTrimmed),qe(o).append('<a class="stamped-review-read-more" style="margin-left:10px; cursor:pointer;">read more</span>'),qe(o).append('<span class="original-review" style="display:none !important;">'+s+"</span>"))))})),qe(".stamped-review-reply .stamped-review-reply-body, .stamped-review-reply .stamped-review-content-body").each((function(){if(!qe(this).attr("data-link-processed")){qe(this).attr("data-link-processed",!0);var e=qe(this).html();qe(this).html(e.linkify())}}))}function z(){var e,t,a=qe(Ke).attr("data-keywords");if(a){for(qe(".stamped-reviews-filter-label").show(),qe(".stamped-summary-keywords").show(),qe(Ke).removeAttr("data-keywords"),qe(".stamped-summary-keywords-list",Ke).html(""),e="",t=a.split(","),i=0;i<t.length;i++)e+="<li>"+t[i]+"</li>";qe(e).appendTo(qe(".stamped-summary-keywords-list",Ke))}}function V(){qe(t).on("click keypress",".stamped-review-read-more",(function(t){if(!0===s(t)){qe(this).closest(".stamped-review-content-body").find(".stamped-review-read-more").hide();var a=qe(this).closest(".stamped-review-content-body").find(".original-review").html();qe(this).closest(".stamped-review-content-body").html(a),e.macyInstanceStamped&&e.macyInstanceStamped.reInit()}}))}function M(){qe(".stamped-summary-ratings").removeClass("selected"),qe(".stamped-summary-ratings .summary-rating").each((function(){qe(this).removeClass("selected")})),qe(".summary-rating-bar").each((function(){qe(this).removeClass("selected")}))}function W(){function a(e,t){!function(e,t){var a=new FileReader;a.onload=function(e){var a,s,i,r,o,n,d=new DataView(e.target.result);if(65496!=d.getUint16(0,!1))return t(-2);for(a=d.byteLength,s=2;s<a;)if(i=d.getUint16(s,!1),s+=2,65505==i){if(1165519206!=d.getUint32(s+=2,!1))return t(-1);for(r=18761==d.getUint16(s+=6,!1),s+=d.getUint32(s+4,r),o=d.getUint16(s,r),s+=2,n=0;n<o;n++)if(274==d.getUint16(s+12*n,r))return t(d.getUint16(s+12*n+8,r))}else{if(65280!=(65280&i))break;s+=d.getUint16(s,!1)}return t(-1)},a.readAsArrayBuffer(e.slice(0,65536))}(e,(function(e){e}));var a=new FileReader;a.onloadend=function(){s(a.result,e.type,e.name,t)},a.onerror=function(){console.log("There was an error reading the file!")},a.readAsDataURL(e)}function s(e,t,a,s){var r=new Image;r.src=e,r.onload=function(t,a,s){setTimeout((function(){r.width,r.height;qe(".stamped-file-holder").append('<div class="stamped-file-photo" data-index="'+t+'"><img src="'+e+'" width="70" /><span style="display:none;">'+s+'</span><div class="stamped-file-photo-remove" data-index="'+t+'">x</div></div>'),i(e,t,s)}),100)}(s,0,a),r.onerror=function(){console.log("There was an error processing your file!")}}function i(e,t,a){var s=function(e,t){for(var a=e.split(","),s=a[0].match(/:(.*?);/)[1],i=atob(a[1]),r=i.length,o=new Uint8Array(r);r--;)o[r]=i.charCodeAt(r);return new File([o],t,{type:s})}(e,a);at.push(s)}var r;e.File&&e.FileReader&&e.FormData?((r=qe("#stamped-file-uploader-input")).on("change",(function(e){for(var s,i,o=e.target.files,n=0;n<o.length;n++){if(s=o[n],i=new FileReader,ye("stamped:photo:selected"),Se>=5)return void ye("stamped:photo:maxed");if(Se++,s.type.match("image"))a(s,Se);else{if(s.size/1048576>50)return ye("stamped:photo:sizeError"),void alert("Sorry, you cannot add this video to your review. Up to 50mb is allowed.");i.onload=function(){var e,a=new Blob([i.result],{type:s.type}),r=URL.createObjectURL(a),o=t.createElement("video"),n='<div class="stamped-file-photo" data-index="'+Se+'"><img src="https://s3-us-west-2.amazonaws.com/stamped.io/cdn/images/icons/icon-video-placeholder.png" width="70" /><span style="display:none;">'+s.name+'</span><div class="stamped-file-photo-remove" data-index="'+Se+'">x</div></div>',d=function(){e()&&(o.removeEventListener("timeupdate",d),o.pause())};o.addEventListener("loadeddata",(function(){e()?o.removeEventListener("timeupdate",d):qe(".stamped-file-holder").append(n),at.push(s)})),e=function(){var e,a,i=t.createElement("canvas");return i.width=o.videoWidth,i.height=o.videoHeight,i.getContext("2d").drawImage(o,0,0,i.width,i.height),(a=(e=i.toDataURL()).length>1e5)&&(qe(".stamped-file-holder").append('<div class="stamped-file-photo" data-index="'+Se+'"><img src="'+e+'" width="70" /><span style="display:none;">'+s.name+'</span><div class="stamped-file-photo-remove" data-index="'+Se+'">x</div></div>'),URL.revokeObjectURL(r)),a},o.addEventListener("timeupdate",d),o.preload="metadata",o.src=r,o.muted=!0,o.playsInline=!0,o.play()},i.readAsArrayBuffer(s)}s&&(/^image\//i.test(s.type)||/^video\//i.test(s.type)?console.log("is image, begin upload"):(ye("stamped:photo:invalid"),console.log("Not a valid image!")))}r.val("")})),qe(t).on("click",".stamped-file-photo-remove",(function(){var e=qe(this).parent(".stamped-file-photo"),t=e.index();at.splice(t,1),Se=at.length,e.remove()}))):console.log("File upload is not supported!")}function B(t,a,s,i){var r,o,n,d;if(Ke.length&&!Pe){ue("Loading Main Widget...");var l=Ke.attr("data-product-id"),p=Ke.attr("data-product-ids"),c=Ke.attr("data-name"),m=Ke.attr("data-product-type"),u=Ke.attr("data-product-sku")||Ke.attr("data-product-sku2"),h=Ke.attr("data-user-reference"),f=Ke.attr("data-take-reviews"),v=Ke.attr("data-keyword"),w=Ke.attr("data-widget-language"),y=Ke.attr("data-widget-country-iso"),b=Ke.attr("data-widget-type"),S=Ke.attr("data-load-type")||qe(".stamped-container",Ke).attr("data-widget-load-type"),k=Ke.attr("data-search"),_=Ke.attr("data-cache")||Fe.is_disable_cache||null,I=qe(".stamped-container",Ke).attr("data-widget-style"),C=Ke.attr("data-tags-exclude"),O=Ke.attr("data-tags-include"),T=Fe.metafields;"slider"==I&&(S="continue"),c&&(c=c.replace("!","")),a||(a=Ke.attr("data-sort")||qe(".stamped-container",Ke).attr("data-widget-sort")),"continue"===S&&(i=!0),qe("#stamped-main-widget-placeholder").length&&qe("#stamped-main-widget-placeholder").append(Ke),Pe=!0,t&&!i&&ie(".stamped-reviews"),Ke.addClass("stamped-main-widget-loading"),r=qe("<span>Loading more...</span>").prependTo(qe("#stamped-reviews-tab")),o=qe.param(se({productId:l,productIds:p,productName:c,productType:m,productSKU:u,userReference:h,page:t||1,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,take:f||5,sort:a,rating:s,keyword:v,widgetLanguage:w,widgetCountryIso:y,widgetType:b,search:k,isUseCache:_,tagsExclude:C,tagsInclude:O})),qe.isEmptyObject(it)||(o+="&"+qe.param(it)),d={type:(n=T.length)?"POST":"GET",data:n?JSON.stringify({metafields:T}):null,dataType:"json",url:Fe.SECURE_ENDPOINT+"/widget"+(n?"/preview":"")+"?"+o,success:function(e){var s,i,o,n,d,p;ue("Loaded Main Widget..."),Pe=!1,Ke.removeClass("stamped-main-widget-loading"),r.remove();var c=e.product,m=e.widget,u=qe("#stamped-main-widget .stamped-container").length;qe(".question-form-wrapper").clone(),qe(".stamped-questions").clone();u||Ke.empty().html(c),s="function"==typeof qe.parseHTML?qe.parseHTML(m):qe(m),0==qe(".stamped-content",Ke).children().length?qe(".stamped-content",Ke).append(qe(s)):(i=qe(".stamped-reviews",Ke),o=qe('[class="stamped-review"]',s),("continue"!==S||null===t&&void 0===t||1===t&&t)&&qe('.stamped-reviews [class*="stamped-review"]',Ke).remove(),n=qe(".stamped-pagination",s).attr("data-page",t),(d=qe(".stamped-reviews .stamped-pagination",Ke)).length?qe(o).insertBefore(d):qe(o).appendTo(".stamped-reviews",Ke),p=qe(".stamped-tabs",s),qe(".stamped-tabs",Ke).replaceWith(p),n.length?d.length?d.replaceWith(n):i.append(n):d.remove()),a&&qe(".stamped-sort-select",Ke).length&&"none"!==qe('.stamped-sort-select option[value="'+a+'"]',Ke).css("display")&&(qe(".stamped-sort-select",Ke).val(a),qe(".stamped-container",Ke).attr("data-widget-sort",a),qe(Ke).attr("data-sort",a)),qe(".new-review-form").hide(),qe(".new-question-form").hide(),ye("stamped:reviews:loaded"),qe(".stamped-summary-actions-newreview").attr("aria-controls","new-review-form_"+(null!=l?l:"")),function(){var e=Array.prototype.slice.call(qe(".stamped-pagination > li"));e.forEach((function(e){e.classList.contains("active")?e.children[0].setAttribute("aria-current","page"):e.removeAttribute("aria-current")}))}()},error:function(){}},T.length&&(d.contentType="application/json"),null!=ke&&ke.abort(),ke=qe.ajax(d)}v&&g({topic:v},l),k&&g({search:k},l)}function H(e,t){return e.replace(new RegExp(t+"(?!([^<]+)?<)","gi"),'<span class="stamped-keyword-highlight">$&</span>')}function J(t,a){var s;if((Ke=qe(rt)).length){var i=Ke.attr("data-product-id"),r=Ke.attr("data-product-sku"),o=Ke.attr("data-product-type"),n=Ke.attr("data-name"),d=Ke.attr("data-take-questions")||5,l=Ke.attr("data-search-qna");if(a||(a=Ke.attr("data-sort-qna")||qe(".stamped-container",Ke).attr("data-widget-sort-qna")),s=Ke.data("linkify")||!1,!i)return;ue("Loading Q&A"),qe.ajax({type:"GET",url:Fe.SECURE_ENDPOINT+"/widget/questions",data:{productId:i,productSKU:r,productType:o,productTitle:n,page:t||1,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,take:d||5,search:l,sort:a},success:function(e){var i,r,o,n,l,p,c,m;1==e.a&&qe(".stamped-questions").length&&(i=e.result,r=e.t,o=e.form,e.p,n=e.avatar,qe("#tab-questions").text(),qe("#tab-questions").attr("data-count",r),function(e){if(qe(".stamped-questions").length&&!qe(".question-form-wrapper").length){var t=qe('<div class="question-form-wrapper">').html(e);qe(".new-review-form").before(t)}}(o),l=qe('<div id="stamped-questions-tab" class="stamped-questions" role="tabpanel" aria-labelledby="tab-questions" tabindex="-1">'),qe(".stamped-questions").html(""),l.append(i),n&&(p=qe(".stamped-review #stamped-review-avatar",l),c=qe('<img src="'+n+'" width="100">'),p.html(c)),(m=qe(".stamped-questions-placeholder")).length?(qe(".stamped-questions",m).html(""),qe(".stamped-questions",m).replaceWith(l),qe(".stamped-questions",m).length||(qe(".stamped-questions").appendTo(m),qe(".stamped-questions").replaceWith(l)),qe(".stamped-questions",m).show(),qe("#tab-questions").hide(),qe(".question-form-wrapper").prependTo(m),qe(".stamped-summary-actions-newquestion").prependTo(m)):(qe(".stamped-questions").replaceWith(l),t?qe(".stamped-questions").show():qe(".stamped-questions").hide()),function(e,t,a){var s,i,r,o=e>0?e/a<1?1:Math.ceil(e/a):1;if(1!=o){var n='<div class="stamped-pagination" id="stamped-pagination-question"><div><span id="stamped-pagination-prev" class="previous"><a href="#" onclick="StampedFn.pageQuestions(this)" role="link" tabindex="0" data-product-id="" data-page="'+(t-1)+'"><</a></span><span id="pages"></span><span id="stamped-pagination-next" class="next"><a onclick="StampedFn.pageQuestions(this)" role="link" tabindex="0" data-product-id="" data-page="'+(t+1)+'">></a></span></div></div>',d=qe(".stamped-questions"),l=qe(".stamped-questions-placeholder");l.length&&(d=qe(".stamped-questions",l)),(s=qe(".stamped-pagination",d)).length?s.replaceWith(n):d.append(n),s=qe(".stamped-pagination",d);e=o,t=t;var p=[];if(p.push(1),e<=7){for(r=2;r<e;r++)p.push(r);e==t&&p.push(t)}for(e>=8&&(t-2>=1&&(t-2!=1&&p.push(t-2),p.push(t-1)),1!=t&&p.push(t),(i=t+2)<=e&&(p.push(t+1),i!=e&&p.push(t+2))),1==t||1==t?qe("#stamped-pagination-prev",s).hide():qe("#stamped-pagination-prev",s).show(),e==t||1==e?qe("#stamped-pagination-next",s).hide():qe("#stamped-pagination-next",s).show(),e!=t&&p.push(e),r=0;r<p.length;r++)p[r]==t?qe("#pages",s).append(' <span class="page active"><a style="cursor:pointer;" onclick="StampedFn.pageQuestions(this)" role="button" tabindex="0" data-product-id="" data-page="'+p[r]+'">'+p[r]+"</a></span> "):qe("#pages",s).append(' <span class="page"><a style="cursor:pointer;" onclick="StampedFn.pageQuestions(this)" role="button" tabindex="0" data-product-id="" data-page="'+p[r]+'">'+p[r]+"</a></span> ")}}(r,t||1,d),m.length?t>1&&ie(".stamped-questions-placeholder"):t>1&&ie(rt),a||qe(".stamped-questions-filter .stamped-sort-select").val("recent"),s&&qe(".stamped-review-reply-body",l).each((function(){if(!qe(this).attr("data-link-processed")){qe(this).attr("data-link-processed",!0);var e=qe(this).html();qe(this).html(e.linkify())}})),ye("stamped:questions:loaded"))}})}}function Q(e,t){qe("#stamped-questions-placeholder, .stamped-questions-placeholder").length||(qe(".stamped-tabs #tab-reviews").removeClass("active"),qe(".stamped-tabs #tab-questions").removeClass("active"),"questions"==t?qe(".stamped-tabs #tab-questions").addClass("active"):"reviews"==t&&qe(".stamped-tabs #tab-reviews").addClass("active"),e&&(qe(e).addClass("active"),t=qe(e).data("type")),"reviews"==t?(qe(".stamped-reviews").show(),qe(".stamped-reviews-filter").show(),qe(".stamped-questions").hide(),qe(".stamped-questions-filter").hide(),qe(".stamped-reviews").attr("tabindex",0),qe(".stamped-questions").attr("tabindex",-1),qe("#stamped-sort-select").show()):"questions"==t&&(qe(".stamped-reviews").hide(),qe(".stamped-reviews-filter").hide(),qe(".stamped-questions").show(),qe(".stamped-questions-filter").show(),qe(".stamped-reviews").attr("tabindex",-1),qe(".stamped-questions").attr("tabindex",0),qe("#stamped-sort-select").hide()),qe(".new-review-form").hide(),qe(".new-question-form").hide())}function Y(e,t){var a,s,r,o,n,d,l,p=[];for(i=0;i<e.length;i++)if(a=e[i],1!=t||a.reviewUserPhotos||a.reviewUserVideos){if(s={photos:[],videos:[],name:a.author,via:"Photos",title:a.reviewTitle,body:a.reviewMessage,date:a.reviewDate,reply:a.reviewReply,dateReplied:a.dateReplied,dateFull:a.dateCreated,verifiedType:a.reviewVerifiedType,rating:a.reviewRating,products:[{url:a.productUrl,title:a.productName,imageUrl:a.productImageUrl,imageLargeUrl:a.productImageLargeUrl,productUrl:a.productDirectUrl||""}],review_id:a.id,votes:{up:a.reviewVotesUp,down:a.reviewVotesDown},options:[]},a.reviewUserPhotos||a.reviewUserVideos){if(a.reviewUserVideos)for(r=a.reviewUserVideos.split(","),ii=0;ii<r.length;ii++)o="//s3.us-west-2.amazonaws.com/stamped.io/uploads/videos/"+r[ii],n="//cdn.stamped.io/uploads/videos/"+r[ii]+".jpg",o.indexOf(".mp4")<0&&(o+=".mp4"),o.indexOf("nothumb")>=0&&(n=""),s.photos.push({videoUrl:o,imageThumbnailUrl:n});if(a.reviewUserPhotos)for(d=a.reviewUserPhotos.split(","),l="//cdn.stamped.io/uploads/photos/",a.reviewUserPhotosWatermark&&(l="//cdn.stamped.io/"+a.reviewUserPhotosWatermark+"/uploads/photos/"),ii=0;ii<d.length;ii++)s.photos.push({imageUrl:l+d[ii],imageThumbnailUrl:"//cdn.stamped.io/uploads/photos/thumb/"+d[ii]})}else s.photos.push({imageUrl:a.productImageLargeUrl,imageThumbnailUrl:a.productImageUrl});if(a.reviewOptionsList&&a.reviewOptionsList.length)for(ii=0;ii<a.reviewOptionsList.length;ii++)s.options.push({message:a.reviewOptionsList[ii].message,value:a.reviewOptionsList[ii].value});p.push(s)}return p}function X(t,a){var s=qe(t),i=s.attr("data-element-id"),r=s.attr("data-widget-type"),o=(s.attr("data-widget-persist-data"),s.attr("data-review-id")),n=s.attr("data-review-ids")?s.attr("data-review-ids").toString().split(","):null,d=s.attr("data-product-id"),l=s.attr("data-product-ids")?s.attr("data-product-ids").toString().split(","):null,p=s.attr("data-product-category")||s.attr("data-product-type"),c=s.attr("data-product-brand"),m=s.attr("data-product-sku"),u=(s.attr("data-product-title"),s.attr("data-limit-words")),h=s.attr("data-random"),g=s.attr("data-show-avatar"),f=s.attr("data-take"),v=s.attr("data-fill-empty"),w=s.attr("data-min-rating"),y=s.attr("data-min-length"),b=s.attr("data-rating"),S=s.attr("data-tags"),k=s.attr("data-tags-exclude"),_=s.attr("data-topic"),I=s.attr("data-syndication")||!0,C=s.data("with-photos"),O=s.data("with-videos"),T=s.data("sort-reviews"),E=s.data("widget-data"),x=s.data("widget-language"),U=s.data("widget-country-iso"),R=s.data("instagram-gallery-id"),F=s.data("album-id"),L=s.data("customer-email"),j=s.data("customer-first-name"),A=s.data("customer-id"),G=r.indexOf("rewards")>-1?Fe.referral_code:null,N=s.data("is-preview");return{type:r,reviewId:o,reviewIds:n,productId:d,productIds:l,productCategory:p,productBrand:c,productSKU:m,limitWords:u,random:h,showAvatar:g,isFillEmpty:v,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,page:a,skip:f,minRating:w,minLength:y,rating:b,isWithPhotos:C,isWithVideos:O,sortReviews:T,instagramGalleryId:R,albumId:F,dataType:E,widgetLanguage:x,widgetCountryIso:U,tags:S,tagsExclude:k,topic:_,isSyndication:I,elementId:i,customerEmail:L,customerFirstName:j,customerExternalId:A,referralCode:G,isPreview:N}}function Z(e,t){var a=Fe.SECURE_ENDPOINT+"/widget/reviews/batch";qe.ajax({type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({data:t}),xhrFields:{withCredentials:!0},url:a,success:function(t){for(var a,s=t.length,i=100,r=0;r<s;r++)t[r]&&(i+=50,a=t[r].elementId,ee(qe("rewards"==e?'#stamped-rewards-widget[data-element-id="'+a+'"]':'#stamped-reviews-widget[data-element-id="'+a+'"]'),t[r],t.translations,i))}})}function ee(a,s,i,r,o){setTimeout((function(){var i,r,n,d;if(s){var l=s.template,p=s.lang,c=a.attr("data-widget-type"),m=a.data("widget-persist-data")||!1;qe(a).attr("data-lang",p||"en"),"instagram-feed"!=c&&"instagram-feed-dev"!=c&&"visual-gallery"!=c&&1!=m&&qe(a).html(""),"single"==c?(a.append(l),StampedWidgetSingleFn,StampedWidgetSingleFn.init(s.data,a,qe)):"full-page"==c||"full-page-nps"==c?(i=a.attr("data-rich-snippet"),r="/"==location.pathname,s.total>0&&"true"==i&&!r&&(n={"@context":"http://schema.org","@type":"Product",name:s.shop,aggregateRating:{"@type":"AggregateRating",ratingValue:s.rating,reviewCount:s.total}},(d=t.createElement("script")).type="application/ld+json",d.innerHTML=JSON.stringify(n),t.getElementsByTagName("head")[0].appendChild(d)),a.append(l),StampedWidgetFullPageFn,StampedWidgetFullPageFn.init(s,a,qe)):"full-page-multiple"==c?(a.append(l),StampedWidgetFullPageMultipleFn,StampedWidgetFullPageMultipleFn.init(s,a,qe)):"reviews-highlight"==c?(a.append(l),StampedWidgetReviewsHighlightFn,StampedWidgetReviewsHighlightFn.init(s,a,qe)):"reviews-popup"==c?(a.append(l),StampedWidgetReviewsPopupFn,StampedWidgetReviewsPopupFn.init(s,a,qe)):"people-highlight"==c?(a.append(l),StampedWidgetPeopleHighlightFn,StampedWidgetPeopleHighlightFn.init(s,a,qe)):"drawer"==c?(a.append(l),StampedWidgetDrawerFn,StampedWidgetDrawerFn.init(s,a,qe)):"carousel"==c?(a.append(l),StampedCarouselFn,StampedCarouselFn.init(s,a,qe)):"carousel-nps"==c?(a.append(l),StampedCarouselNPSFn,StampedCarouselNPSFn.init(s,a,qe)):"carousel-checkout-comments"==c?(a.append(l),StampedCarouselCheckoutCommentFn,StampedCarouselCheckoutCommentFn.init(s,a,qe)):"carousel-photos"==c?(a.append(l),StampedCarouselPhotosFn,StampedCarouselPhotosFn.init(s.data,a,qe)):"site-badge"==c?(a.append(l),StampedSiteBadgeFn,StampedSiteBadgeFn.init(s,a,qe)):"top-rated"==c?(a.append(l),StampedTopRatedFn,StampedTopRatedFn.init(s,a,qe)):"wall-photos"==c?(a.append(l),StampedWallPhotosFn,StampedWallPhotosFn.init(s,a,qe),o&&ie(a)):"checkout-comments"==c?(a.append(l),StampedCheckoutCommentsFn,StampedCheckoutCommentsFn.init(s,a,qe)):"instagram-feed"==c?(qe(a).is(":empty")&&a.append(l),StampedInstagramFeedFn,StampedInstagramFeedFn.init(s,a,qe)):"visual-gallery"==c?(e.stampedVisualGalleryDataArr||a.append(l),StampedVisualGalleryFeedFn,StampedVisualGalleryFeedFn.init(s,a,qe)):"facebook-messenger-optin"==c?(StampedFacebookMessengerOptinFn,StampedFacebookMessengerOptinFn.init(s,a,qe)):"nps-submission-form"==c?(a.append(l),StampedNPSSubmissionForm,StampedNPSSubmissionForm.init(s,a,qe)):"rewards-summary"==c?(a.append(l),StampedRewardsSummary,StampedRewardsSummary.init(s,a,qe)):"rewards-how-it-works"==c?(a.append(l),StampedRewardsHowItWorks,StampedRewardsHowItWorks.init(s,a,qe)):"rewards-referral-modal"==c?(a.append(l),StampedRewardsReferralModal,StampedRewardsReferralModal.init(s,a,qe)):"rewards-referral-claim-modal"==c?(a.append(l),StampedRewardsReferralClaimModal,StampedRewardsReferralClaimModal.init(s,a,qe)):"rewards-earnings"==c||"rewards-earnings-v2"==c?(a.append(l),StampedRewardsEarnings,StampedRewardsEarnings.init(s,a,qe)):"rewards-spendings"==c||"rewards-spendings-v2"==c?(a.append(l),StampedRewardsSpendings,StampedRewardsSpendings.init(s,a,qe)):"rewards-vip-tiers"==c?(a.append(l),StampedRewardsVIPTiers,StampedRewardsVIPTiers.init(s,a,qe)):"rewards-referral"==c?(a.append(l),StampedRewardsReferral,StampedRewardsReferral.init(s,a,qe)):"rewards-activities"==c?(a.append(l),StampedRewardsActivities,StampedRewardsActivities.init(s,a,qe)):"rewards-redeem-variable-slider"==c?(a.append(l),StampedRewardsRedeemVariableSlider,StampedRewardsRedeemVariableSlider.init(s,a,qe)):"rewards-redeem-select-options"==c&&(a.append(l),StampedRewardsRedeemSelectOptions,StampedRewardsRedeemSelectOptions.init(s,a,qe)),function(){var e=qe(".free-tier-banner");e.lenght<1&&qe(".free-tier-banner").detach().appendTo("#stamped-reviews-widget")}(),ye("stamped:reviews:widget:loaded")}}),r)}function te(e,a,s){var i,r;s?((i=new Date).setTime(i.getTime()+864e5*s),r="; expires="+i.toGMTString()):r="",t.cookie=e+"="+a+r+"; path=/; SameSite=None; Secure"}function ae(e){for(var a,s=e+"=",i=t.cookie.split(";"),r=0;r<i.length;r++){for(a=i[r];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(s))return a.substring(s.length,a.length)}return null}function se(e){for(var t in e)(null===e[t]||""===e[t]||void 0===e[t])&&delete e[t];return e}function ie(e){var t;if(qe(e).length&&(ue("Animation: "+(t=qe(rt).attr("data-animation"))),"false"!==t&&!1!==t)){if(1==Ce)return;Ce=!0;var s=qe(e),i=qe("html, body"),r=qe(rt).attr("data-offset")||qe(e).attr("data-offset")||1;a()&&(r=qe(rt).attr("data-offset-mobile")||qe(e).attr("data-offset-mobile")||1),i.on("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",(function(){i.stop(),Ce=!1})),i.animate({scrollTop:s.offset().top-r},t||1e3,(function(){i.off("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove"),Ce=!1}))}}function re(e){return e.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}function oe(e){var t,a;"review"==e?(Q(null,"reviews"),t=qe(".new-review-form"),(a=qe(".new-question-form")).slideUp(),a.removeClass("stamped-visible"),t.hasClass("stamped-visible")?(t.slideUp(),t.removeClass("stamped-visible"),t.attr("aria-expanded","false")):(t.slideDown(400,(function(){ie("#stamped-main-widget .new-review-form")})),t.addClass("stamped-visible"),t.attr("aria-expanded","true")),qe(t).find("input[type=text]").length>0&&qe(t).find("input[type=text]").get(0).focus()):"question"==e&&(Q(null,"questions"),t=qe(".new-question-form"),(a=qe(".new-review-form")).slideUp(),a.removeClass("stamped-visible"),t.hasClass("stamped-visible")?(t.slideUp(),t.removeClass("stamped-visible")):(t.slideDown(400,(function(){ie(".new-question-form")})),t.addClass("stamped-visible"),a.attr("aria-expanded","false")),qe(t).find("input[type=text]").length>0&&qe(t).find("input[type=text]").get(0).focus())}function ne(e){var t,a,s;t=qe(e).parents(".new-review-form"),s=qe(e).attr("data-value"),a=qe(e).parent(),t.find("input[name='reviewRating']").val(s),function(e,t){t.find("a:lt("+e+")").removeClass("fa-star-o").addClass("fa-star-checked"),t.find("a:gt("+(e-1)+")").removeClass("fa-star-checked").addClass("fa-star-o")}(s,a),function(e){var t,a=Array.prototype.slice.call(e.parentNode.children);a.forEach((function(e){e.setAttribute("aria-pressed",!1)})),t=e.getAttribute("aria-pressed"),e.setAttribute("aria-pressed",!JSON.parse(t))}(e)}function de(e,t,a,s){qe(rt).length&&(function(e){var t=function(e,t){for(var a=[],s=0;s<t;)a[s++]=e;return a.join("")}("",e.reviewRating),a=Ke.attr("data-image-url")||"",s="https://stamped.io/facebookpost?caption="+t+" "+encodeURIComponent(e.reviewTitle)+"&name="+t+" "+encodeURIComponent(e.reviewTitle)+"&description="+encodeURIComponent(e.reviewMessage)+"&link="+encodeURIComponent(e.productUrl)+"&picture="+encodeURIComponent(a.replace("%3F","?")),i="https://www.facebook.com/dialog/feed?app_id=941057476855139&display=popup&link="+encodeURIComponent(s)+"&name="+encodeURIComponent(e.reviewTitle)+"&redirect_uri=https://stamped.io/shares?productId="+e.productId,r="https://twitter.com/intent/tweet?text="+t+" "+e.reviewMessage.substr(0,140)+"&url="+encodeURIComponent(e.productUrl),o="https://plus.google.com/share?url="+encodeURIComponent(e.productUrl),n=qe(".stamped-thank-you .stamped-share-links");qe(".facebook",n).attr("href",i).attr("target","_blank"),qe(".twitter",n).attr("href",r).attr("target","_blank"),qe(".google",n).attr("href",o).attr("target","_blank")}(e),qe(".stamped-user-review",Ke).hide(),qe(".stamped-thank-you",Ke).show(),qe(".stamped-thank-you p",Ke).show(),qe(".stamped-thank-you .stamped-share-links",Ke).show(),qe(".new-review-form",Ke).hide(),qe(".edit-review-form",Ke).hide(),qe(".stamped-summary-actions-newreview").hide(),qe("#stamped-button-submit",Ke).removeAttr("disabled"),s&&qe("#stamped-button-submit",Ke).val(s),ie(rt),function(e,t,a){var s,i,r,o;if(null!=ae("stamped-user-reviews")){for(s=JSON.parse(ae("stamped-user-reviews")),i=!1,r=0;r<s.length;r++)if(s[r].pid==e){i=!0,s[r];break}!i&&e&&t&&1==a&&(s.length>=10&&s.splice(0,1),s.push({pid:e,v:t}),te("stamped-user-reviews",JSON.stringify(s),1))}else e&&t&&1==a&&(o=[{pid:e,v:t}],te("stamped-user-reviews",JSON.stringify(o),1))}(a.productId,t.userReference,!0)),ye("stamped:reviews:submitted")}function le(e){var t=1;e&&(t=qe(e).data("page")),J(t)}function pe(e,t,a){var s,i;qe||jQuery&&(qe=jQuery),a&&qe(a).closest(rt).length&&(Ke=qe(a).closest(rt)),Ke.attr("data-product-id"),(s=qe(".stamped-summary-ratings.selected .summary-rating-bar.selected",Ke).attr("data-rating"))&&(t=s),qe(".stamped-sort-select",Ke).length&&(i=qe(".stamped-sort-select",Ke).val()),B(e,i,t)}function ce(e){var t;"qna"==e?(qe(".stamped-questions-filter .stamped-summary-actions-clear").hide(),qe(".stamped-questions-search-input").val(""),qe(".stamped-questions-search-clear").hide(),qe(Ke).removeAttr("data-search-qna"),le()):(qe("select.stamped-filter-select").each((function(){qe(this).val("")})),qe(".stamped-summary-keywords-list li").removeClass("selected"),qe(Ke).removeAttr("data-keyword"),qe(".stamped-reviews-filter .stamped-summary-actions-clear").hide(),qe(".stamped-reviews",Ke).removeAttr("data-filtered"),qe(".stamped-sort-select").length&&(t=qe(".stamped-sort-select").val()),it={},qe(".stamped-reviews-search-input").val(""),qe(".stamped-reviews-search-clear").hide(),qe(Ke).removeAttr("data-search"),M(),B(1,t,null,!0))}function me(t,a){a||(a=e.location.href),t=t.replace(/[\[\]]/g,"\\$&");var s=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(a);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}function ue(t,a){var s="true"==me("stamped_debug")||1==e.stamped_debug,i=e.stamped_debug_level||me("stamped_debug_level");s&&(a||console.log("[Stamped.io]",t),a&&i&&console.log("[Stamped.io level"+i+"]",t))}function he(e,a){(Ne=t.createElement("script")).type="text/javascript",Ne.charset="UTF-8",Ne.src=e;var s=t.getElementsByTagName("script")[0];s.parentNode.insertBefore(Ne,s),Ne.onload=Ne.onreadystatechange=a}function ge(e,t){try{return"undefined"!=typeof Storage&&(localStorage.setItem(e,JSON.stringify(t)),!0)}catch(e){}}function fe(e){try{if("undefined"!=typeof Storage){var t;try{t=JSON.parse(localStorage.getItem(e))||null}catch(a){t=localStorage.getItem(e)}return t}return!1}catch(e){}}function ve(e,t){var a,s,i="stamped_app_key",r=fe(i);r&&r.apiKey?(ue(r),ye("stamped:init:getAppKey",{detail:r}),we(r)):((a=new XMLHttpRequest).onreadystatechange=function(){var e,t;4===a.readyState&&200===a.status&&((e=JSON.parse(a.responseText))&&e.apiKey&&(ge(i,e),ye("stamped:init:getAppKey",{detail:e}),!0===e.skip||(appKey=e.apiKey,t={apiKey:appKey},"undefined"!=typeof Shopify?t.storeUrl=Shopify.shop:t.sId=e.sId,we(t))))},s="","shopify"==e?s="shopShopifyDomain="+t:"bigcommerce"==e&&(s="storeHash="+t),a.open("GET","https://stamped.io/api/getappkey?"+s,!0),a.send())}function we(t){if(1==e.isInitializedStamped)return ue("Already initalized"),StampedFn.loadWidget(!0),void StampedFn.loadDisplayWidgets();if(e.isInitializedStamped=!0,t&&(De=t.storeUrl,e.StampedGlobalOptions=t),e.StampedGlobalOptions&&e.StampedGlobalOptions.apiKey){var a="true"==me("stamped_force_jquery")||Fe.is_force_jquery;"undefined"==typeof jQuery||1==a?he("https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js",(function(){qe=jQuery.noConflict(!0),n(),e.isInitializedStamped=!0})):(n(0,jQuery),e.isInitializedStamped=!0)}}function ye(a,s){var i;e.CustomEvent?i=new CustomEvent(a,s):(i=t.createEvent("CustomEvent")).initCustomEvent(a,!0,!0,s);try{t.dispatchEvent(i)}catch(e){}}var be,Se,ke,_e,Ie,Ce,Oe,Te,Ee,xe,Ue,Re,Fe={SERVICE_HOST:{svc_loyalty_widget:"https://stamped.io/api/widgets/loyalty",svc_loyalty_engine:"https://stamped.io/api/v3/loyalty",svc_identity:"https://stamped.io/api/v3/identity"},DEFAULT_ENDPOINT:e.stamped_ajax_url||"//stamped.io/api",SECURE_ENDPOINT:e.stamped_ajax_secure_url||"https://stamped.io/api",metafields:e.mainWidgetMetafields||"",exclude_main_css:e.stamped_exclude_main_css||!1,exclude_font:e.stamped_disable_font||!1,disable_single_review:e.stamped_disable_review_single||!1,modal_ugc_image_viewer:e.stamped_modal_ugc_viewer_type||"image",is_preview:e.isStampedLauncherPreview||!1,is_init_rewards:!0,is_force_jquery:e.stamped_force_jquery||!1,is_disable_cache_badge:e.stamped_disable_cache_badge||!1,is_disable_cache:e.stamped_disable_cache||!1,referral_code:null,is_rewards_code_copy:!1,is_ignore_submit_error:!1,rewards_apply_discount_url_format:e.stamped_rewards_apply_discount_url_format||"",slick_options:e.stamped_slick_options||{dots:!1,infinite:!1,speed:300,slidesToShow:4,slidesToScroll:4,slide:".stamped-review",initialSlide:0,rows:0,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]},includes_options:{rewards_button_js:!0,rewards_window_js:!0}},Le=!1,je=!1,Ae="";let Ge=e.location.href.split("?")[1];if(Ge&&(Ge=Ge.split("#")[0]),Ge){let e=new URLSearchParams(Ge);"loyalty2023"===e.get("test")&&(console.log("test loyalty 2023 preview"),je=!0),e.has("testLoyaltyAccount")&&(console.log("test loyalty 2023 account"),Ae=e.get("testLoyaltyAccount"))}var Ne,qe,Pe=!1,$e=!1,De="";e.StampedGlobalOptions={},e.isInitializedStamped=!1;var Ke,ze,Ve,Me,We,Be,He,Je,Qe,Ye,Xe,Ze,et,tt=[],at=[],st=[],it={},rt="div#stamped-main-widget",ot={},nt="html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video { margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline; }";e.newFormatStringStamped=(e,t)=>{let a=e;return a?(t.forEach(((e,t)=>{a=a.replaceAll(`{${t}}`,e)})),a):""},String.prototype.formatStringStamped=function(){for(var e,t=this,a=0;a<arguments.length;a++)e=new RegExp("\\{"+a+"\\}","gi"),t=t.replace(e,arguments[a]);return t},function(){function a(e,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var s=t.createEvent("CustomEvent");return s.initCustomEvent(e,a.bubbles,a.cancelable,a.detail),s}if("function"==typeof e.CustomEvent)return!1;a.prototype=e.Event.prototype,e.CustomEvent=a}(),e.lazyLoadOptionsStamped={elements_selector:".stamped-lazyload"},e.addEventListener("LazyLoad::Initialized",(function(t){e.LazyLoadStamped=t.detail.instance}),!1),function(){"use strict";var a=void 0!==e,s=a&&!("onscroll"in e)||"undefined"!=typeof navigator&&/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent),i=a&&"IntersectionObserver"in e,r=a&&"classList"in t.createElement("p"),n={elements_selector:"img",container:s||a?t:null,threshold:300,thresholds:null,data_src:"src",data_srcset:"srcset",data_sizes:"sizes",data_bg:"bg",class_loading:"stamped-lazyload-loading",class_loaded:"stamped-lazyload-loaded",class_error:"stamped-lazyload-error",load_delay:0,auto_unobserve:!0,callback_enter:null,callback_exit:null,callback_reveal:null,callback_loaded:null,callback_error:null,callback_finish:null,use_native:!1},d=function(a,s){var i,r=new a(s);try{i=new CustomEvent("LazyLoad::Initialized",{detail:{instance:r}})}catch(a){(i=t.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:r})}try{e.dispatchEvent(i)}catch(s){}},l=function(e,t){return e.getAttribute("data-"+t)},p=function(e,t,a){var s="data-"+t;null!==a?e.setAttribute(s,a):e.removeAttribute(s)},c=function(e){return"true"===l(e,"was-processed")},m=function(e,t){return p(e,"ll-timeout",t)},u=function(e){return l(e,"ll-timeout")},h=function(e,t){e&&e(t)},g=function(e,t){e._loadingCount+=t,0===e._elements.length&&0===e._loadingCount&&h(e._settings.callback_finish)},f=function(e){for(var t,a=[],s=0;t=e.children[s];s+=1)"SOURCE"===t.tagName&&a.push(t);return a},v=function(e,t,a){a&&e.setAttribute(t,a)},w=function(e,t){v(e,"sizes",l(e,t.data_sizes)),v(e,"srcset",l(e,t.data_srcset)),v(e,"src",l(e,t.data_src))},y={IMG:function(e,t){var a=e.parentNode;a&&"PICTURE"===a.tagName&&f(a).forEach((function(e){w(e,t)})),w(e,t)},IFRAME:function(e,t){v(e,"src",l(e,t.data_src))},VIDEO:function(e,t){f(e).forEach((function(e){v(e,"src",l(e,t.data_src))})),v(e,"src",l(e,t.data_src)),e.load()}},b=function(e,t){var a,s,i=t._settings,r=e.tagName,o=y[r];if(o)return o(e,i),g(t,1),void(t._elements=(a=t._elements,s=e,a.filter((function(e){return e!==s}))));!function(e,t){var a=l(e,t.data_src),s=l(e,t.data_bg);a&&(e.style.backgroundImage='url("'.concat(a,'")')),s&&(e.style.backgroundImage=s)}(e,i)},S=function(e,t){r?e.classList.add(t):e.className+=(e.className?" ":"")+t},k=function(e,t,a){e.addEventListener(t,a)},_=function(e,t,a){e.removeEventListener(t,a)},I=function(e,t,a){_(e,"load",t),_(e,"loadeddata",t),_(e,"error",a)},C=function(e,t,a){var s=a._settings,i=t?s.class_loaded:s.class_error,o=t?s.callback_loaded:s.callback_error,n=e.target;!function(e,t){r?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")}(n,s.class_loading),S(n,i),h(o,n),g(a,-1)},O=["IMG","IFRAME","VIDEO"],T=function(e,t){var a=t._observer;x(e,t),a&&t._settings.auto_unobserve&&a.unobserve(e)},E=function(e){var t=u(e);t&&(clearTimeout(t),m(e,null))},x=function(e,t,a){var s=t._settings;!a&&c(e)||(O.indexOf(e.tagName)>-1&&(function(e,t){var a=function a(i){C(i,!0,t),I(e,a,s)},s=function s(i){C(i,!1,t),I(e,a,s)};!function(e,t,a){k(e,"load",t),k(e,"loadeddata",t),k(e,"error",a)}(e,a,s)}(e,t),S(e,s.class_loading)),b(e,t),function(e){p(e,"was-processed","true")}(e),h(s.callback_reveal,e),h(s.callback_set,e))},U=function(e){return!!i&&(e._observer=new IntersectionObserver((function(t){t.forEach((function(t){return function(e){return e.isIntersecting||e.intersectionRatio>0}(t)?function(e,t){var a=t._settings;h(a.callback_enter,e),a.load_delay?function(e,t){var a=t._settings.load_delay,s=u(e);s||(s=setTimeout((function(){T(e,t),E(e)}),a),m(e,s))}(e,t):T(e,t)}(t.target,e):function(e,t){var a=t._settings;h(a.callback_exit,e),a.load_delay&&E(e)}(t.target,e)}))}),{root:(a=e._settings).container===t?null:a.container,rootMargin:a.thresholds||a.threshold+"px"}),!0);var a},R=["IMG","IFRAME"],F=function(e,t){return function(e){return e.filter((function(e){return!c(e)}))}((a=e||function(e){return e.container.querySelectorAll(e.elements_selector)}(t),Array.prototype.slice.call(a)));var a},L=function(e,t){this._settings=function(e){return o({},n,e)}(e),this._loadingCount=0,U(this),this.update(t)};L.prototype={update:function(e){var t,a=this,i=this._settings;this._elements=F(e,i),!s&&this._observer?(function(e){return e.use_native&&"loading"in HTMLImageElement.prototype}(i)&&((t=this)._elements.forEach((function(e){-1!==R.indexOf(e.tagName)&&(e.setAttribute("loading","lazy"),x(e,t))})),this._elements=F(e,i)),this._elements.forEach((function(e){a._observer.observe(e)}))):this.loadAll()},destroy:function(){var e=this;this._observer&&(this._elements.forEach((function(t){e._observer.unobserve(t)})),this._observer=null),this._elements=null,this._settings=null},load:function(e,t){x(e,this,t)},loadAll:function(){var e=this;this._elements.forEach((function(t){T(t,e)}))}},a&&function(e,t){if(t)if(t.length)for(var a,s=0;a=t[s];s+=1)d(e,a);else d(e,t)}(L,e.lazyLoadOptionsStamped)}(),function(e,t){"object"==typeof module&&module.exports?(module.exports=t(),module.exports.default=module.exports):e.timeagoStamped=t()}(void 0!==e?e:this,(function(){function e(e){return e instanceof Date?e:isNaN(e)?/^\d+$/.test(e)?new Date(t(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(e)):new Date(t(e))}function t(e){return parseInt(e)}function a(e,a,s){a=m[a]?a:m[s]?s:"en";for(var i=0,r=e<0?1:0,o=e=Math.abs(e);e>=u[i]&&i<h;i++)e/=u[i];return(e=t(e))>(0===(i*=2)?9:1)&&(i+=1),m[a](e,i,o)[r].replace("%s",e)}function s(t,a){return((a=a?e(a):new Date)-e(t))/1e3}function i(e){for(var t=1,a=0,s=Math.abs(e);e>=u[a]&&a<h;a++)e/=u[a],t*=u[a];return s=(s%=t)?t-s:t,Math.ceil(s)}function r(e){return e.dataset.timeagoStamped?e.dataset.timeagoStamped:o(e,g)}function o(e,t){return e.getAttribute?e.getAttribute(t):e.attr?e.attr(t):void 0}function n(e,t){return e.setAttribute?e.setAttribute(f,t):e.attr?e.attr(f,t):void 0}function d(e,t){this.nowDate=e,this.defaultLocale=t||"en"}function l(e,t){return new d(e,t)}var p="second_minute_hour_day_week_month_month".split("_"),c="".split("_"),m={en:function(e,t){if(0===t)return["just now","right now"];var a=p[parseInt(t/2)];return e>1&&(a+="s"),[e+" "+a+" ago","in "+e+" "+a]},zh_CN:function(e,t){if(0===t)return["",""];var a=c[parseInt(t/2)];return[e+a+"",e+a+""]}},u=[60,60,24,7,365/84,1],h=6,g="datetime",f="data-tid",v={};return d.prototype.doRender=function(e,t,r){var o,d=s(t,this.nowDate),l=this;e.innerHTML=a(d,r,this.defaultLocale),v[o=setTimeout((function(){l.doRender(e,t,r),delete v[o]}),Math.min(1e3*i(d),2147483647))]=0,n(e,o)},d.prototype.formatDateString=function(e,t){return a(s(e,this.nowDate),t,this.defaultLocale)},d.prototype.render=function(e,t){void 0===e.length&&(e=[e]);for(var a=0,s=e.length;a<s;a++)this.doRender(e[a],r(e[a]),t)},d.prototype.setLocale=function(e){this.defaultLocale=e},l.register=function(e,t){m[e]=t},l.cancel=function(e){var t;if(e)(t=function(e){return o(e,f)}(e))&&(clearTimeout(t),delete v[t]);else{for(t in v)clearTimeout(t);v={}}},l})),Se=0,ke=null,_e=[],Ie=!1,Ce=!1,String.linkify||(String.prototype.linkify=function(){return this.replace(/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,'<a href="$&" target="_blank">$&</a>').replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,'$1<a href="http://$2" target="_blank">$2</a>').replace(/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim,'<a href="mailto:$&">$&</a>')});var dt=!1,lt=null;if((Oe=t.getElementById("stamped-script-widget"))||(Oe=t.getElementById("stamped-script-init")),Te="",Oe&&(Te=Oe.src),Ee=!1,(Te.indexOf("skipCss=true")>0||1==Fe.exclude_main_css)&&(Ee=!0),Ee||function(e){for(var a,s,i,r=t.styleSheets,o=0,n=r.length;o<n;o++)if(r[o]&&r[o].href&&r[o].href.indexOf(e)>-1)return;(a=t.createElement("link")).rel="stylesheet",a.href=e,a.type="text/css",(s=t.getElementsByTagName("link")[0])?s.parentNode.insertBefore(a,s):(i=t.getElementsByTagName("head")[0],a.setAttribute("async",""),i.appendChild(a))}("//cdn1.stamped.io/files/widget.min.css"),"undefined"!=typeof Shopify&&(xe=!1,Shopify.shop&&(null!=Oe&&(Te.indexOf("skip=true")>-1&&(xe=!0),!(Ue=Oe.getAttribute("data-api-key"))&&Te.indexOf("apiKey")>-1&&(Ue=me("apiKey",Te)),Ue&&(xe=!0,we({apiKey:Ue,storeUrl:Shopify.shop}))),xe||ve("shopify",Shopify.shop)),Shopify.Checkout&&"undefined"==typeof StampedShopifyCheckout)){if("function"==typeof e.StampedShopifyCheckout)return!1;he("//cdn1.stamped.io/files/shopify-checkout.min.js",(function(){ye("stamped:script-shopify-checkout:loaded")}))}if(null!=Oe){(Re=Oe.getAttribute("data-store-hash"))&&ve("bigcommerce",Re);var pt=Oe.getAttribute("data-store-id"),ct=Oe.getAttribute("data-api-key"),mt=Oe.getAttribute("data-auto-init");pt&&ct&&"false"!=mt&&we({apiKey:ct,sId:pt})}return{init:we,initRewards:p,reloadUGC:l,toggleForm:oe,setRating:ne,submitForm:function(t){var a,s,i,r,o,n,d,l,p=Ke.data("label-submitting"),c=qe(".new-review-form .stamped-button-primary",Ke).val(),m=null;if(a=function(e){var t,a={};return qe(e).hasClass("new-review-form")||(e=qe(e).parents(".new-review-form")),t=qe("input,textarea,select,radio",e).serializeArray(),qe.each(t,(function(){void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""})),a}(t),a.reviewRating&&a.author&&a.reviewMessage.trim()){for(r in s={productName:Ke.attr("data-name"),productId:Ke.attr("data-product-id"),productSKU:Ke.attr("data-product-sku"),productType:Ke.attr("data-product-type"),productDescription:Ke.attr("data-description"),productImageUrl:Ke.attr("data-image-url"),productUrl:Ke.attr("data-url"),reviewSource:"widget",userReference:Ke.attr("data-user-reference")},a=qe.extend(a,s),m=a,i=new FormData,a)(o=a[r]).indexOf("+")>-1&&r.indexOf("customFormOption")>-1&&(o=a[r].replace("+","%2B")),i.append(r,o);for(d in n=0,at)i.append("image"+n,at[n]),a["image"+n]=at[n],n++;ue(Object.prototype.toString.call(i)),ue(i),l={url:Fe.SECURE_ENDPOINT+"/reviews3?"+qe.param(se({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl})),cache:!1,processData:!1,contentType:!1,type:"POST",data:i._blob?i._blob():i,beforeSend:function(){qe("#stamped-button-submit",Ke).attr("disabled","disabled"),p&&qe("#stamped-button-submit",Ke).val(p)},error:function(e){ye("stamped:reviews:submitError"),1==Fe.is_ignore_submit_error?de(m,e,s,c):(qe("#stamped-button-submit",Ke).removeAttr("disabled"),c&&qe("#stamped-button-submit",Ke).val(c))},success:function(e){de(m,e,s,c)}},qe.ajax(l)}},submitQuestionForm:function(t){var a=qe(t||"#new-question-form"),s=qe(rt);if(a.length&&s.length){var i=s.data("name"),r=s.data("description"),o=s.data("product-sku"),n=s.data("url"),d=s.data("image-url"),l=a.serializeArray();l.push({name:"productName",value:i}),l.push({name:"productDescription",value:r}),l.push({name:"productSKU",value:o}),l.push({name:"productUrl",value:n}),l.push({name:"productImageUrl",value:d}),l.push({name:"apiKey",value:e.StampedGlobalOptions.apiKey}),l.push({name:"sId",value:e.StampedGlobalOptions.sId}),l.push({name:"storeUrl",value:e.StampedGlobalOptions.storeUrl}),qe('input[type="submit"]',a).attr("disabled","disabled"),qe.ajax({type:"POST",url:"https://stamped.io/api/questions",data:qe.param(l),crossDomain:!0,success:function(){a.hide(),qe(".question-form-wrapper .stamped-form-message-success").show(),qe(".stamped-form-message-success").attr("aria-live","polite"),a[0].reset(),qe('input[type="submit"]',a).removeAttr("disabled")}})}},toggleFormEdit:function(){qe(".edit-review-form",Ke).toggle()},pageQuestions:le,sortQuestions:function(e){e.value&&J(1,e.value)},pageReviews:pe,sortReviews:function(e){Ke.attr("data-product-id"),e.value&&B(1,e.value,null,!0)},filterReviews:function(e){var t,a,s=qe("option:first-child",e).text(),i=e.value;it={},t=1,qe("select.stamped-filter-select").each((function(){var e=qe("option:first-child",this).text(),a=this.value;it["qt"+t]=e,it["qv"+t]=a,t++})),qe(".stamped-reviews-filter .stamped-summary-actions-clear").show(),qe(".stamped-reviews",Ke).attr("data-filtered","true"),qe(".stamped-sort-select").length&&(a=qe(".stamped-sort-select").val()),B(1,a,null,!0),s&&i&&g({customOptionTitle:s,customOptionValue:i},Ke.attr("data-product-id"))},filterClear:ce,pageWidget:function(e,t){var a=qe(e).data("page"),s=qe(e).closest("#stamped-reviews-widget");s.attr("data-page",a),function(e,t,a){var s=Fe.SECURE_ENDPOINT+"/widget/reviews",i=X(e,t);a=a||{},qe.ajax({type:"GET",url:s+"?"+qe.param(se(i)),dataType:"json",success:function(t){ee(e,t,0,0,!0),a.callback&&a.callback()}})}(s,a,t)},loadBadges:P,loadWidget:N,loadDisplayWidgets:$,loadDisplayWidgetsRewards:D,voteReview:function(t,a,s){var i=qe(t),r=i.parent();r.fadeTo("slow",.3),i.addClass("disable-link"),qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/reviews/vote",data:{reviewId:a,vote:s,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl},success:function(e){qe(".stamped-thumbs-up",r).attr("data-count",e.voteUp),qe(".stamped-thumbs-down",r).attr("data-count",e.voteDown),qe(".stamped-ugc-modal-vote-up",r).attr("data-count",e.voteUp),qe(".stamped-ugc-modal-vote-down",r).attr("data-count",e.voteDown),qe(".stamped-thumbs-up i",r).html("&nbsp; "+e.voteUp),qe(".stamped-thumbs-down i",r).html("&nbsp; "+e.voteDown),r.fadeTo("slow",1),i.removeClass("disable-link")}})},openUGCModal:function(e,a,i,r,o,n,d,l,p){var c,m,u,h,g,f,v,w;1!==r&&r||(e=Y(e,o)),null!=e||e.length||E(a,n),d||(d="en");var y,b,S,k='<div class="stamped-ugc-modal" data-lang="'+d+'" role="dialog" aria-modal="true" aria-label="Customer Review Photos" data-keyboard="true" tabindex="-1"> <div class="stamped-ugc-modal-wrapper" role="region" aria-roledescription="carousel" aria-label="carousel" aria-label="Shop our Instagram look"><span href="javascript:void(0)" title="Close" aria-label="Close" role="button" class="stamped-modal-close show-mobile" style="display:none;" tabindex="0">X</span> <div class="stamped-ugc-modal-nav stamped-ugc-modal-nav-previous" role="button" data-direction="left" tabindex="0" aria-label="Previous Photo"> <i class="stamped-fa stamped-fa-angle-left"></i> </div> <div class="stamped-ugc-modal-image-wrapper" role="group" aria-roledescription="slides" aria-label="slide"> <div class="stamped-ugc-modal-image"></div> <ul></ul> </div> <div class="stamped-ugc-modal-content"> <span href="javascript:void(0)" title="Close" aria-label="Close" role="button" class="stamped-modal-close" tabindex="0">X</span> <div class="stamped-ugc-modal-content-wrapper"> <div class="stamped-ugc-modal-user"> <div class="stamped-ugc-modal-user-source"></div><h1 class="stamped-ugc-modal-user-username"></h1> </div> <div class="stamped-ugc-modal-caption"></div><div class="stamped-ugc-modal-votes"></div> <div class="stamped-ugc-modal-tags"> <span class="stamped-ugc-modal-tag"><a aria-label="Link to Product" {0} target="_top"> <div class="stamped-ugc-modal-tags-product-image-wrapper"><img {1} class="stamped-ugc-modal-tags-product-image" onerror=\'this.style.display = "none"\' alt="{2}" /></div> <div class="stamped-ugc-modal-tags-product-title">{2}</div> </a><div class="stamped-ugc-modal-tags-btn" data-shoppable-url="{3}"></div> </span> </div> </div> </div> <div class="stamped-ugc-modal-nav stamped-ugc-modal-nav-next" role="button" data-direction="right" tabindex="0" aria-label="Next Photo"> <i class="stamped-fa stamped-fa-angle-right"></i> </div> <div class="stamped-ugc-modal-list-photos" role="group"><ul></ul></div> </div> </div>',_=(qe(i).attr("data-hover-text"),qe(i).attr("data-shop-button-text"),qe(i).attr("data-url-param")||""),I=qe(i).attr("data-url-store")||De||"";for(qe(i).attr("data-cropped"),qe(i).attr("data-page"),qe(i).attr("data-take"),qe("#stamped-ugc-modal").length||((y=qe(k)).attr("data-modal-type",r),y.attr("data-modal-shoppable",p||!1),qe(y).appendTo(t.body),y.focus()),c="",m=e.length,b||(b=qe(".stamped-ugc-modal-tags:first",y).html()),u=e?e.length:0,h=0;h<m;h++)(f=(g=e[h]).imageUrl)&&(c+=templateBlock.formatStringStamped(u,f),u++),g.photos.length&&g.photos[0].imageUrl&&(_e[h]=new Image,_e[h].src=g.photos[0].imageUrl);if(qe(".stamped-ugc-media-block-template",i).append(c),!S){function C(t){switch(t.preventDefault(),t.keyCode){case 37:x("left");break;case 39:x("right");break;case 27:e()}}function a(e){v=e.touches[0].clientX,w=e.touches[0].clientY}function i(e){if(v&&w){var t=e.touches[0].clientX,a=e.touches[0].clientY,s=v-t,i=w-a;Math.abs(s)>Math.abs(i)&&x(s>0?"right":"left"),v=null,w=null}}function e(){qe(t).off("keydown",C),y.remove(),y=null,qe("body").removeClass("stamped-modal-open")}qe(t).on("keydown",C),y.on("click",".stamped-modal-close",(function(t){t.target==this&&!0===s(t)&&e()})),y.on("click keypress",".stamped-ugc-modal-nav-previous, .stamped-ugc-modal-nav-next",(function(e){if(!0===s(e)){var t=qe(this).attr("data-direction");x(t)}})),Ie||(Ie=!0),t.addEventListener("touchstart",a,!1),t.addEventListener("touchmove",i,!1),v=null,w=null}S=!0;var O=function(){var e=Number(qe(this).text())+1,t=qe(this).data("image-url");qe(".stamped-ugc-modal-image-wrapper ul li").removeClass("active"),qe(".stamped-ugc-modal-image-wrapper ul li:nth-child("+e+")").addClass("active"),"image"==Fe.modal_ugc_image_viewer?qe(".stamped-ugc-modal-image",y).html('<img src="'+t+'" alt="Customer Photo" />'):qe(".stamped-ugc-modal-image",y).css("background-image","url("+t+")"),ye("stamped:ugcmodal:paged")},T=function(){var e=qe(this).data("index-review"),t=qe(this).data("index-photo");qe(".stamped-ugc-modal-list-photos ul li").removeClass("active"),qe(".stamped-ugc-modal-list-photos ul li[data-index-review="+e+"][data-index-photo="+t+"]").addClass("active"),E(e,t),ye("stamped:ugcmodal:paged")},E=function(a,i){var r,o,p,c,m,u,g,f,v,w,S,k,E,x,U,R,F,L,j,A=e[a];if(null!=A&&null!=A.photos){if(null!==i?(n=i,i>A.photos.length-1&&(n=0)):n?n>A.photos.length-1&&(n=0):n=0,!qe(".stamped-ugc-modal-list-photos ul li",y).length){for(r=0;r<e.length;r++)for(o=0;o<e[r].photos.length;o++){var G=a==r&&i==o?"active":"",N=(e[r].photos[o].imageUrl,e[r].name+" "+e[r].title),q=e[r].photos[o].imageThumbnailUrl,P=t.createElement("li");P.className=G,P.innerHTML="",P.className+=" stamped-lazyload",(p=t.createAttribute("data-index-review")).value=r,P.setAttributeNode(p),(v=t.createAttribute("data-index-photo")).value=o,P.setAttributeNode(v),P.setAttribute("role","button"),P.setAttribute("tabindex",0),P.setAttribute("aria-label",N),C.LazyLoadStamped&&LazyLoadStamped.update?((c=t.createAttribute("data-bg")).value="url("+q+")",P.setAttributeNode(c)):P.style.background="url("+q+")",qe(".stamped-ugc-modal-list-photos ul",y).append(P),P.onclick=T}qe(t).on("click keypress",".stamped-ugc-modal-list-photos li.stamped-lazyload",(function(e){s(e)&&(qe(this).attr("aria-current","true"),qe(this).siblings().attr("aria-current","false"))}));try{C.LazyLoadStamped&&LazyLoadStamped.update&&LazyLoadStamped.update()}catch(e){}}for(qe(".stamped-ugc-modal-list-photos li.stamped-lazyload.active").attr("aria-current","true"),qe(".stamped-ugc-modal-list-photos li.stamped-lazyload.active").siblings().attr("aria-current","false"),null!=A.photos[n]&&(m=A.photos[n].imageUrl,u=A.photos[n].videoUrl,m?"image"==Fe.modal_ugc_image_viewer?(qe("video",qe(".stamped-ugc-modal-image",y)).remove(),qe(".stamped-ugc-modal-image",y).html('<img src="'+m+'" alt="'+A.via+" photo uploaded by "+A.name+" on "+A.dateFull+'" />')):(qe("video",qe(".stamped-ugc-modal-image",y)).remove(),qe(".stamped-ugc-modal-image",y).css("background-image","url("+m+")")):u&&qe(".stamped-ugc-modal-image",y).fadeOut("",(function(){qe(".stamped-ugc-modal-image",y).css("background-image",'url("")'),qe(".stamped-ugc-modal-image",y).html('<video class="stamped-ugc-modal-video" src="'+u+'" width="100%" controls autoplay />'),qe(this).fadeIn()}))),qe(".stamped-ugc-modal-image-wrapper ul",y).html(""),ii=0;ii<A.photos.length;ii++)g=ii===n?"active":"",(f=t.createElement("li")).className=g,f.innerHTML=ii,(v=t.createAttribute("data-image-url")).value=A.photos[ii].imageUrl,f.setAttributeNode(v),qe(".stamped-ugc-modal-image-wrapper ul",y).append(f),f.onclick=O;if(qe(".stamped-ugc-modal-user-source").text(A.via),(w=qe(".stamped-ugc-modal-user-username",y)).text(A.name),w.attr("data-verified-type",A.verifiedType),w.attr("data-username",A.name),S="Verified Buyer",k="Shop Now",l&&"en"!=d&&(S=l.label_verified_buyer||S,k=l.label_shop_now||k),w.append('<span class="stamped-verified-badge">'+S+"</span>"),qe(".stamped-ugc-modal-tags-btn",y).append("<span>"+k+"</span>"),E="",A.rating){for(x=0;x<A.rating;x++)E+='<i class="stamped-fa stamped-fa-star" aria-hidden="true"></i>';for(x=0;x<5-A.rating;x++)E+='<i class="stamped-fa stamped-fa-star-o" aria-hidden="true"></i>'}if(U="",A.options&&A.options.length){for(U+='<ul class="">',h=0;h<A.options.length;h++){var $=A.options[h].message,D=A.options[h].value;U+='<li data-value="'+re($)+'"><span class="stamped-ugc-modal-options-message">'+$+'</span> <span class="stamped-ugc-modal-options-value">'+D+"</span></li>"}U+="</ul>"}for(A.reply||(A.reply=""),R=A.dateFull?new Date(A.dateFull):new Date(A.date),F=(new timeagoStamped).formatDateString(R),"en"!=d&&(F=A.date),qe(".stamped-ugc-modal-caption",y).html('<div class="stamped-ugc-modal-date" data-date="'+A.date+'">'+F+'</div><div class="stamped-ugc-modal-caption-rating">'+E+'</div><div class="stamped-ugc-modal-caption-options">'+U+'</div><h2 class="stamped-ugc-modal-caption-title">'+(A.title||"")+'</h2> <div class="stamped-ugc-modal-caption-body">'+A.body+'</div> <div class="stamped-ugc-modal-caption-reply">'+A.reply+"</div>"),qe(".stamped-ugc-modal-votes",y).html('<span class="stamped-ugc-modal-vote-up" aria-pressed="false" role="button" aria-label="Rate review as helpful" tabindex="0" data-count="'+A.votes.up+'" onclick="StampedFn.voteReview(this, '+A.review_id+',1)"><i class="stamped-fa stamped-fa-thumbs-up"></i></span><span class="stamped-ugc-modal-vote-down" aria-pressed="false" tabindex="0" role="button" aria-label="Rate review as not helpful" data-count="'+A.votes.down+'" onclick="StampedFn.voteReview(this, '+A.review_id+',-1)"><i class="stamped-fa stamped-fa-thumbs-down"></i></span>'),qe(".stamped-ugc-modal-tags",y).html(""),h=0;h<A.products.length;h++)(L=A.products[h]).title=L.title?L.title:"",I?(L.url=L.url.replace("?storeUrl=https://",""),L.url=L.url+"?storeUrl="+I):_&&(L.url=L.url+"?param="+_),j=L.imageUrl||L.imageLargeUrl,L.imageUrl?qe(".stamped-ugc-modal-tags",y).append(b.formatStringStamped('href="'+L.url+'" rel="nofollow"','src="'+j+'"',L.title,L.productUrl)):qe(".stamped-ugc-modal-tags",y).append(b.formatStringStamped('href="'+L.url+'" rel="nofollow"',"",L.title,L.productUrl));y.attr("data-review-index",a),y.attr("data-photo-index",n),qe(".stamped-ugc-modal-votes > span").click((function(){var e;Array.prototype.slice.call(this.parentNode.children).forEach((function(e){e.setAttribute("aria-pressed",!1)})),e=this.getAttribute("aria-pressed"),this.setAttribute("aria-pressed",!JSON.parse(e))})),y.hasClass("open")||(y.addClass("open"),qe("body").addClass("stamped-modal-open"),ye("stamped:ugcmodal:open"))}},x=function(e){var t,a;if(y.hasClass("open"))if(y.attr("data-review-index"),y.attr("data-photo-index"),qe('[data-direction="right"]',y).removeClass("nav-disabled"),qe('[data-direction="left"]',y).removeClass("nav-disabled"),"left"==e)(t=qe(".stamped-ugc-modal-list-photos ul li.active").prev()).click(),t.length||qe('[data-direction="left"]',y).addClass("nav-disabled");else{if("right"!=e)return;a=qe(".stamped-ugc-modal-list-photos ul li.active").next(),qe(a.click()),a.length||(qe('[data-direction="right"]',y).addClass("nav-disabled"),"instagram"==y.attr("data-modal-type")&&ye("stamped:ugcmodal:last"))}};null!=e&&e.length&&E(a,n)},openUGCPhoto:function(t,a,s,i){var r,o;if(dt){for(r=null,o=0;o<st.length;o++)st[o].id==t&&(r=o);null!=r&&StampedFn.openUGCModal(st,r,qe(rt),null,null,s,lt),dt=!1}else{dt=!0;var n=Fe.SECURE_ENDPOINT+"/widget/reviews",d=qe(Ke).attr("data-product-sku")||"",l="",p="",c=[];!0===i?(a=qe(Ke).attr("data-product-id")||"",l=qe(Ke).attr("data-name")||"",p=qe(Ke).attr("data-product-type")||""):qe(".stamped-reviews .stamped-review",Ke).each((function(){var e=qe(this).attr("id");(e=e.replace("stamped-review-",""))&&c.push(e)})),qe.ajax({type:"GET",url:n+"?"+qe.param(se({type:"widget-carousel-photos",reviewId:t,reviewIds:c,productId:a,productSKU:d,productType:p,productTitle:l,random:!1,isFillEmpty:!1,page:1,skip:100,minRating:1,isWithPhotos:!0,apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl})),dataType:"json",success:function(e){var i,r;for(st=e.data,i=null,r=0;r<st.length;r++)st[r].id==t&&(i=r);null!=i&&(lt=e.lang,StampedFn.openUGCModal(st,i,qe(rt),null,null,s,lt,e.translations)),dt=!1,a}})}return!1},initOptions:e.StampedGlobalOptions,loadSurveyOptin:function(a){var s,i=setInterval((function(){void 0!==e.StampedGlobalOptions&&(null!==a&&a.orderId&&qe.ajax({type:"GET",url:"https://stamped.io/api/plugin/facebookmessenger?"+qe.param(se({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,orderId:a.orderId,customerEmail:a.customerEmail})),success:function(e){var a,s,i;qe("body").append(e.html),a=qe("#stamped-facebook-optin .fb-send-to-messenger")[0].outerHTML,(s=t.createElement("iframe")).height="100",s.width="100%",i="<!DOCTYPE html> <html> <head> <meta charset='utf-8' /> <title></title> </head> <script> var fbPageId, fbUserRef; window.fbAsyncInit = function() { FB.init({ appId : '941057476855139', xfbml : true, version : 'v6.0' }); FB.Event.subscribe('send_to_messenger', function(e) { var modal = window.top.document.getElementById('stamped-facebook-optin'); if (e.event == 'rendered'){ modal.style.display = 'block'; } if (e.event == 'opt_in'){ console.log('hide'); modal.style.display = 'none'; } }); }; (function(d, s, id){ var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) {return;} js = d.createElement(s); js.id = id; js.src = '//connect.facebook.net/en_US/sdk.js'; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk') ); <\/script> <body>"+a+"</body> </html>",t.body.appendChild(s),qe(s).appendTo("#stamped-facebook-optin .fb-send-to-messenger"),s.contentWindow.document.open(),s.contentWindow.document.write(i),s.contentWindow.document.close()}}),clearInterval(i)),++s>=5&&clearInterval(i)}),2e3)},closeSurveyOptin:function(){qe("#stamped-facebook-optin").remove()},triggerEvent:ye,on:function(e,a){t.addEventListener?t.addEventListener(e,a):t.attachEvent("on"+e,(function(){a.call(t)}))},jQuery:qe,stampedLog:ue,getOptions:function(){return Fe},setOptions:function(e){Object.assign(Fe,e)},getLoggedInCustomer:function(){return ot.customer},getDataRewards:function(){return ot},loadLauncherView:I,scrollLauncherView:function(e){StampedFn.toggleLauncher(!0),setTimeout((function(){var t=qe(e,Ze).offset();qe(".stamped-rewards-content-container",Ze).scrollTop(t.top-155),ue(qe(".stamped-rewards-content-container",Ze)),ue(t),ue(e)}),500)},toggleLauncher:u,toggleRewardsModal:u,rewardsApplyCode:function(e){var t,a;$btn=qe("#stamped-rewards-apply-code",Ze);var s=qe(".stamped-reward-coupon-code",Ze).text(),i=$btn.text(),o=$btn.data("type"),n=ot.links;if(F("loading"),t=Fe.is_rewards_code_copy||i.indexOf("Copy")>-1||"copy"==o,ye("stamped:rewards:coupon:applied",{detail:s}),1==t)r(s),F("active");else{let t;s=encodeURIComponent(s),t=67527===ot.shopId?`${n.shop}/discount/${s}?redirect=/checkout`:n.shop+"/checkout?discount="+s,"GET",a={},Fe.rewards_apply_discount_url_format&&(t=rewards_apply_discount_url_format.replace("{0}",s)),e&&e.skip||qe.ajax({type:"GET",url:t,data:a,success:function(){F("active")}})}return{code:s,setState:F}},rewardsReferralClaimCode:function(){var t=qe("#referral_claim_email",Ze),a=qe("#stamped-rewards-claim-code",Ze),s=t.val(),i=StampedFn.getOptions();s&&(A(a,"loading",!0),qe.ajax({type:"POST",url:i.SECURE_ENDPOINT+"/v2/rewards/referral/claim?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,email:s,referralCode:i.referral_code,debug:null}),dataType:"json",success:function(e){I("view-coupon",null,{couponCode:e.couponCode,title:e.title,viewTitle:e.title})},error:function(e){var t=e.responseJSON?e.responseJSON.message:e.responseText?JSON.parse(e.responseText).message:"You are not eligible for the reward.";qe(".stamped-reward-card-error",Ze).text(t)},complete:function(){A(a,"active",!0,1e3)}}))},rewardsReferralSendEmail:function(t){var a=qe("#email-to",Ze),s=qe("#email-message",Ze),i=qe(t),r=a.val(),o=s.val(),n=StampedFn.getOptions();r&&(A(i,"loading",!0),qe.ajax({type:"POST",url:n.SECURE_ENDPOINT+"/v2/rewards/referral/send?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,fromEmail:ot.customer.customerEmail,toEmail:r,message:o,debug:null}),data:{},success:function(){},error:function(){},complete:function(){A(i,"active",!1,3e4)}}))},rewardsLink:function(e){var t=ot.links;"login"==e?top.location.href=t.login:"signup"==e&&(top.location.href=t.signup)},rewardsRedeem:function(t,a,s){A(t,"loading",!0),a=a||{},qe.ajax({type:"POST",url:Fe.SECURE_ENDPOINT+"/v2/rewards/redeem?"+qe.param({apiKey:e.StampedGlobalOptions.apiKey,sId:e.StampedGlobalOptions.sId,storeUrl:e.StampedGlobalOptions.storeUrl,campaignId:a.campaignId,points:a.points}),data:ot.customer,dataType:"json",success:function(e){a.campaignId&&A(t,"active",!0,1),v(),s&&s(e)}})},rewardsPointsRefresh:v,rewardsReferralCopy:function(){var e,t=qe(".stamped-reward-referral-wrapper .stamped-reward-copy-icon",Ze);r(ot.customer.urlReferral),e=t.html(),t.html('<i class="far fa-check"></i>'),setTimeout((function(){t.html(e)}),3e3)},rewardsCreateActivity:w,rewardsTriggerEarn:E,rewardsTriggerSpend:x,triggerEarnActivity:T,triggerRedeemActivity:U,claimAffiliateProgramReward:function(){let t=qe("#referral_claim_email",Ze),a=qe("#stamped-rewards-claim-code",Ze),s=t.val(),i={};e.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,t,a){i[t]=a}));const r=i.stamped_referral_code;if(s&&r){A(a,"loading",!0);let t=ot.shopId||e.StampedGlobalOptions.sId,i=e.StampedGlobalOptions.apiKey,o=`${Fe.SERVICE_HOST.svc_loyalty_widget}/customer/affiliate/claim-reward?sId=${t}&apiKey=${i}`;qe.ajax({type:"POST",url:o,data:{claimedBy:s,referralCode:r},dataType:"json",success:function(e){I("view-coupon",null,{couponCode:e.couponCode,title:"Your Rewards",viewTitle:"Your Reward"})},error:function(e){let t=e.responseJSON?e.responseJSON.message:e.responseText?JSON.parse(e.responseText).message:"You are not eligible for the reward.";qe(".stamped-reward-card-error",Ze).text(t)},complete:function(){A(a,"active",!0,1e3)}})}},sendAffiliateInvite:L,resetSendAffiliateInvite:j,getLauncherWindow:function(){return Ze}}}(window,document);